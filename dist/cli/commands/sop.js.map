{"version":3,"file":"sop.js","sources":["../../../src/cli/commands/sop.ts"],"sourcesContent":["/**\n * SOP Commands\n *\n * AI-SDLC Standard Operating Procedures commands for compliance checking,\n * gap analysis, and reporting.\n *\n * @module cli/commands/sop\n */\n\nimport { Command } from 'commander';\nimport { existsSync, writeFileSync, mkdirSync } from 'fs';\nimport { join, resolve } from 'path';\nimport {\n  SOPCategory,\n  ComplianceStatus,\n  SOPPriority,\n  getAllSOPs,\n  getSOPsByCategory,\n  getSOPById,\n  getSopCount,\n  getCategories,\n  checkCompliance,\n  analyzeGaps,\n  createMultiLayerGraph,\n  addComplianceOverlay,\n  exportToVisualizationFormat,\n  getComplianceSummary,\n} from '../../sops/index.js';\n\n/**\n * Create the SOP command group\n */\nexport function createSOPCommands(): Command {\n  const sop = new Command('sop')\n    .description('AI-SDLC SOP compliance commands');\n\n  // sop init\n  sop\n    .command('init')\n    .description('Initialize AI-SDLC SOP standards layer')\n    .option('-p, --path <path>', 'Project root path', process.cwd())\n    .option('-d, --docs <path>', 'Documentation path', 'docs')\n    .option('-c, --categories <categories>', 'SOP categories to include (comma-separated)')\n    .option('-v, --verbose', 'Verbose output')\n    .action(async (options) => {\n      const projectRoot = resolve(options.path);\n      const docsPath = options.docs;\n      const verbose = options.verbose;\n\n      console.log('\\nüèõÔ∏è  Initializing AI-SDLC SOP Standards Layer\\n');\n\n      try {\n        // Parse categories\n        let categories: SOPCategory[] | undefined;\n        if (options.categories) {\n          categories = options.categories.split(',').map((c: string) => c.trim() as SOPCategory);\n        }\n\n        // Create multi-layer graph with standards\n        const graph = createMultiLayerGraph({\n          graphId: `sop-${Date.now()}`,\n          graphName: 'AI-SDLC Compliance Graph',\n          includeAllSOPs: !categories,\n          categories,\n        });\n\n        // Save graph to docs\n        const sopDir = join(projectRoot, docsPath, 'sop');\n        if (!existsSync(sopDir)) {\n          mkdirSync(sopDir, { recursive: true });\n        }\n\n        // Save standards graph\n        const graphPath = join(sopDir, 'standards-graph.json');\n        writeFileSync(graphPath, JSON.stringify(graph, null, 2));\n\n        console.log(`  ‚úì Created standards layer with ${getSopCount()} SOPs`);\n        console.log(`  ‚úì Saved graph to ${graphPath}`);\n\n        if (verbose) {\n          console.log('\\n  Categories included:');\n          for (const category of getCategories()) {\n            const count = getSOPsByCategory(category).length;\n            console.log(`    - ${category}: ${count} SOPs`);\n          }\n        }\n\n        // Create SOP index document\n        const indexPath = join(sopDir, 'SOP-INDEX.md');\n        const indexContent = generateSOPIndex(categories);\n        writeFileSync(indexPath, indexContent);\n        console.log(`  ‚úì Created SOP index at ${indexPath}`);\n\n        console.log('\\n‚ú® SOP standards layer initialized!\\n');\n        console.log('Next steps:');\n        console.log('  - Run \"kg sop check\" to assess compliance');\n        console.log('  - Run \"kg sop gaps\" to identify gaps');\n        console.log('  - Run \"kg sop report\" to generate compliance report');\n        console.log('');\n\n      } catch (error) {\n        console.error('\\n‚ùå SOP initialization failed:', error);\n        process.exit(1);\n      }\n    });\n\n  // sop check\n  sop\n    .command('check')\n    .description('Check project compliance against AI-SDLC SOPs')\n    .option('-p, --path <path>', 'Project root path', process.cwd())\n    .option('-d, --docs <path>', 'Documentation path', 'docs')\n    .option('-s, --sop <id>', 'Check specific SOP by ID')\n    .option('-c, --category <category>', 'Check SOPs in specific category')\n    .option('--deep', 'Perform deep analysis of file contents')\n    .option('--threshold <number>', 'Minimum compliance threshold (0-100)', '50')\n    .option('-v, --verbose', 'Verbose output')\n    .option('--json', 'Output as JSON')\n    .action(async (options) => {\n      const projectRoot = resolve(options.path);\n      const docsPath = options.docs;\n      const verbose = options.verbose;\n      const threshold = parseInt(options.threshold, 10);\n\n      if (!options.json) {\n        console.log('\\nüîç Checking AI-SDLC SOP Compliance\\n');\n      }\n\n      try {\n        // Build check options\n        const checkOptions: Parameters<typeof checkCompliance>[0] = {\n          projectRoot,\n          docsPath,\n          deepAnalysis: options.deep,\n          assessor: 'cli-automated',\n        };\n\n        if (options.sop) {\n          checkOptions.sopIds = [options.sop];\n        }\n        if (options.category) {\n          checkOptions.categories = [options.category as SOPCategory];\n        }\n\n        // Run compliance check\n        const result = await checkCompliance(checkOptions);\n\n        if (options.json) {\n          console.log(JSON.stringify(result, null, 2));\n          return;\n        }\n\n        // Display results\n        console.log(`  Project: ${result.projectName}`);\n        console.log(`  Overall Score: ${getScoreEmoji(result.overallScore)} ${result.overallScore}%\\n`);\n\n        // Category breakdown\n        console.log('  Category Scores:');\n        for (const [category, score] of Object.entries(result.categoryScores)) {\n          if (score > 0) {\n            console.log(`    ${getScoreEmoji(score)} ${formatCategory(category as SOPCategory)}: ${score}%`);\n          }\n        }\n        console.log('');\n\n        // Assessment summary\n        const compliant = result.assessments.filter(a => a.status === ComplianceStatus.COMPLIANT).length;\n        const partial = result.assessments.filter(a => a.status === ComplianceStatus.PARTIAL).length;\n        const nonCompliant = result.assessments.filter(a => a.status === ComplianceStatus.NON_COMPLIANT).length;\n\n        console.log('  Assessment Summary:');\n        console.log(`    ‚úÖ Compliant: ${compliant}`);\n        console.log(`    üü° Partial: ${partial}`);\n        console.log(`    ‚ùå Non-compliant: ${nonCompliant}`);\n        console.log('');\n\n        // Verbose: show each assessment\n        if (verbose) {\n          console.log('  Detailed Assessments:');\n          for (const assessment of result.assessments) {\n            const sop = getSOPById(assessment.sopId);\n            if (sop) {\n              console.log(`\\n    ${getStatusIcon(assessment.status)} ${sop.title}`);\n              console.log(`       Score: ${assessment.score}%`);\n              console.log(`       Met: ${assessment.requirementsMet.length}/${assessment.requirementsMet.length + assessment.requirementsGaps.length}`);\n            }\n          }\n          console.log('');\n        }\n\n        // Check threshold\n        if (result.overallScore < threshold) {\n          console.log(`  ‚ö†Ô∏è  Below compliance threshold of ${threshold}%`);\n          console.log('     Run \"kg sop gaps\" to see remediation recommendations\\n');\n        } else {\n          console.log(`  ‚ú® Meets compliance threshold of ${threshold}%\\n`);\n        }\n\n        // Evidence summary\n        if (result.evidence.length > 0 && verbose) {\n          console.log(`  Evidence Found: ${result.evidence.length} items`);\n        }\n\n      } catch (error) {\n        console.error('\\n‚ùå Compliance check failed:', error);\n        process.exit(1);\n      }\n    });\n\n  // sop gaps\n  sop\n    .command('gaps')\n    .description('Analyze compliance gaps and generate remediation recommendations')\n    .option('-p, --path <path>', 'Project root path', process.cwd())\n    .option('-d, --docs <path>', 'Documentation path', 'docs')\n    .option('--priority <priority>', 'Minimum gap priority (critical, high, medium, low)')\n    .option('--category <category>', 'Filter by category')\n    .option('--roadmap', 'Include remediation roadmap')\n    .option('-v, --verbose', 'Verbose output')\n    .option('--json', 'Output as JSON')\n    .action(async (options) => {\n      const projectRoot = resolve(options.path);\n      const docsPath = options.docs;\n      const verbose = options.verbose;\n\n      if (!options.json) {\n        console.log('\\nüìã Analyzing Compliance Gaps\\n');\n      }\n\n      try {\n        // First run compliance check\n        const checkResult = await checkCompliance({\n          projectRoot,\n          docsPath,\n          deepAnalysis: true,\n        });\n\n        // Parse filters\n        let minPriority: SOPPriority | undefined;\n        if (options.priority) {\n          minPriority = options.priority as SOPPriority;\n        }\n\n        let categories: SOPCategory[] | undefined;\n        if (options.category) {\n          categories = [options.category as SOPCategory];\n        }\n\n        // Analyze gaps\n        const gapResult = analyzeGaps(checkResult, {\n          minPriority,\n          categories,\n          generateRemediation: true,\n        });\n\n        if (options.json) {\n          console.log(JSON.stringify(gapResult, null, 2));\n          return;\n        }\n\n        // Display summary\n        console.log(`  Total Gaps: ${gapResult.totalGaps}`);\n        console.log(`  Compliance: ${gapResult.summary.compliancePercentage}%`);\n        console.log(`  Complexity: ${gapResult.summary.overallComplexity}\\n`);\n\n        // Priority breakdown\n        console.log('  Gaps by Priority:');\n        console.log(`    üî¥ Critical: ${gapResult.byPriority[SOPPriority.CRITICAL].length}`);\n        console.log(`    üü† High: ${gapResult.byPriority[SOPPriority.HIGH].length}`);\n        console.log(`    üü° Medium: ${gapResult.byPriority[SOPPriority.MEDIUM].length}`);\n        console.log(`    üü¢ Low: ${gapResult.byPriority[SOPPriority.LOW].length}`);\n        console.log('');\n\n        // Category breakdown\n        console.log('  Gaps by Category:');\n        for (const [category, gaps] of Object.entries(gapResult.byCategory)) {\n          if (gaps.length > 0) {\n            console.log(`    ${formatCategory(category as SOPCategory)}: ${gaps.length}`);\n          }\n        }\n        console.log('');\n\n        // Critical gaps detail\n        if (gapResult.criticalGaps.length > 0) {\n          console.log('  üö® Critical Gaps (Immediate Action Required):');\n          for (const gap of gapResult.criticalGaps) {\n            const sop = getSOPById(gap.sopId);\n            console.log(`\\n    ‚Ä¢ ${sop?.title || gap.sopId}`);\n            console.log(`      ${gap.description.substring(0, 80)}...`);\n            console.log(`      Effort: ${gap.effort}`);\n          }\n          console.log('');\n        }\n\n        // Quick wins\n        if (gapResult.roadmap?.quickWins && gapResult.roadmap.quickWins.length > 0) {\n          console.log('  üí° Quick Wins (High Impact, Low Effort):');\n          for (const gap of gapResult.roadmap.quickWins.slice(0, 5)) {\n            const sop = getSOPById(gap.sopId);\n            console.log(`    ‚Ä¢ ${sop?.title || gap.sopId}`);\n          }\n          console.log('');\n        }\n\n        // Roadmap\n        if (options.roadmap && gapResult.roadmap) {\n          console.log('  üìç Remediation Roadmap:');\n          for (const phase of gapResult.roadmap.phases) {\n            console.log(`\\n    Phase ${phase.phase}: ${phase.name}`);\n            console.log(`      Focus: ${phase.focus}`);\n            console.log(`      Gaps: ${phase.gaps.length}`);\n            console.log(`      Effort: ${phase.effort}`);\n          }\n          console.log('');\n        }\n\n        // Verbose: show all gaps\n        if (verbose) {\n          console.log('  All Gaps:');\n          for (const gap of gapResult.gaps) {\n            console.log(`\\n    [${gap.priority.toUpperCase()}] ${gap.id}`);\n            console.log(`      SOP: ${gap.sopId}`);\n            console.log(`      Description: ${gap.description.substring(0, 100)}...`);\n            console.log(`      Remediation: ${gap.remediation.substring(0, 100)}...`);\n          }\n          console.log('');\n        }\n\n      } catch (error) {\n        console.error('\\n‚ùå Gap analysis failed:', error);\n        process.exit(1);\n      }\n    });\n\n  // sop report\n  sop\n    .command('report')\n    .description('Generate comprehensive compliance report')\n    .option('-p, --path <path>', 'Project root path', process.cwd())\n    .option('-d, --docs <path>', 'Documentation path', 'docs')\n    .option('-o, --output <file>', 'Output file path')\n    .option('-f, --format <format>', 'Output format (md, json, html)', 'md')\n    .option('--include-evidence', 'Include evidence details')\n    .option('--include-roadmap', 'Include remediation roadmap')\n    .action(async (options) => {\n      const projectRoot = resolve(options.path);\n      const docsPath = options.docs;\n      const format = options.format;\n\n      console.log('\\nüìù Generating Compliance Report\\n');\n\n      try {\n        // Run compliance check\n        const checkResult = await checkCompliance({\n          projectRoot,\n          docsPath,\n          deepAnalysis: true,\n        });\n\n        // Analyze gaps\n        const gapResult = analyzeGaps(checkResult, {\n          generateRemediation: true,\n        });\n\n        // Create multi-layer graph\n        const graph = createMultiLayerGraph();\n        addComplianceOverlay(graph, checkResult, gapResult);\n        const summary = getComplianceSummary(graph);\n\n        // Generate report content\n        let report: string;\n\n        if (format === 'json') {\n          report = JSON.stringify({\n            checkResult,\n            gapResult,\n            summary,\n            generatedAt: new Date().toISOString(),\n          }, null, 2);\n        } else if (format === 'html') {\n          report = generateHTMLReport(checkResult, gapResult, summary, options);\n        } else {\n          report = generateMarkdownReport(checkResult, gapResult, summary, options);\n        }\n\n        // Output\n        if (options.output) {\n          const outputPath = resolve(options.output);\n          writeFileSync(outputPath, report);\n          console.log(`  ‚úì Report saved to ${outputPath}`);\n        } else {\n          // Default output path\n          const sopDir = join(projectRoot, docsPath, 'sop');\n          if (!existsSync(sopDir)) {\n            mkdirSync(sopDir, { recursive: true });\n          }\n          const outputPath = join(sopDir, `COMPLIANCE-REPORT.${format}`);\n          writeFileSync(outputPath, report);\n          console.log(`  ‚úì Report saved to ${outputPath}`);\n        }\n\n        console.log('\\n‚ú® Report generated successfully!\\n');\n\n      } catch (error) {\n        console.error('\\n‚ùå Report generation failed:', error);\n        process.exit(1);\n      }\n    });\n\n  // sop list\n  sop\n    .command('list')\n    .description('List available AI-SDLC SOPs')\n    .option('-c, --category <category>', 'Filter by category')\n    .option('--irb', 'Show only SOPs requiring AI-IRB review')\n    .option('--json', 'Output as JSON')\n    .action((options) => {\n      let sops = getAllSOPs();\n\n      if (options.category) {\n        sops = getSOPsByCategory(options.category as SOPCategory);\n      }\n\n      if (options.irb) {\n        sops = sops.filter(s => s.irbTypicallyRequired);\n      }\n\n      if (options.json) {\n        console.log(JSON.stringify(sops, null, 2));\n        return;\n      }\n\n      console.log('\\nüìö AI-SDLC Standard Operating Procedures\\n');\n      console.log(`  Total: ${sops.length} SOPs\\n`);\n\n      // Group by category\n      const byCategory = new Map<SOPCategory, typeof sops>();\n      for (const sop of sops) {\n        if (!byCategory.has(sop.category)) {\n          byCategory.set(sop.category, []);\n        }\n        byCategory.get(sop.category)!.push(sop);\n      }\n\n      for (const [category, categorySops] of byCategory) {\n        console.log(`  ${formatCategory(category)} (${categorySops.length}):`);\n        for (const sop of categorySops) {\n          const irb = sop.irbTypicallyRequired ? ' üî¨' : '';\n          console.log(`    ‚Ä¢ ${sop.id}: ${sop.title}${irb}`);\n        }\n        console.log('');\n      }\n    });\n\n  return sop;\n}\n\n/**\n * Helper functions\n */\n\nfunction getScoreEmoji(score: number): string {\n  if (score >= 90) return '‚úÖ';\n  if (score >= 70) return 'üü°';\n  if (score >= 50) return 'üü†';\n  return 'üî¥';\n}\n\nfunction getStatusIcon(status: ComplianceStatus): string {\n  switch (status) {\n    case ComplianceStatus.COMPLIANT:\n      return '‚úÖ';\n    case ComplianceStatus.PARTIAL:\n      return 'üü°';\n    case ComplianceStatus.NON_COMPLIANT:\n      return '‚ùå';\n    case ComplianceStatus.NOT_APPLICABLE:\n      return '‚ö™';\n    case ComplianceStatus.PENDING:\n      return '‚è≥';\n    default:\n      return '‚ùì';\n  }\n}\n\nfunction formatCategory(category: SOPCategory): string {\n  return category\n    .split('-')\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(' ');\n}\n\nfunction generateSOPIndex(categories?: SOPCategory[]): string {\n  const sops = categories\n    ? categories.flatMap(c => getSOPsByCategory(c))\n    : getAllSOPs();\n\n  let content = `---\ntitle: AI-SDLC SOP Index\ntype: standards\ncreated: ${new Date().toISOString().split('T')[0]}\ntags: [sop, ai-sdlc, compliance, standards]\n---\n\n# AI-SDLC Standard Operating Procedures\n\nThis document provides an index of AI-SDLC SOPs applicable to this project.\n\n## Overview\n\n- **Total SOPs**: ${sops.length}\n- **Source**: [AI-SDLC-SOPs](https://github.com/AISDLC/AI-SDLC-SOPs)\n- **Generated**: ${new Date().toISOString()}\n\n## SOPs by Category\n\n`;\n\n  // Group by category\n  const byCategory = new Map<SOPCategory, typeof sops>();\n  for (const sop of sops) {\n    if (!byCategory.has(sop.category)) {\n      byCategory.set(sop.category, []);\n    }\n    byCategory.get(sop.category)!.push(sop);\n  }\n\n  for (const [category, categorySops] of byCategory) {\n    content += `### ${formatCategory(category)}\\n\\n`;\n    for (const sop of categorySops) {\n      const irb = sop.irbTypicallyRequired ? ' üî¨' : '';\n      content += `- **${sop.id}**: ${sop.title}${irb}\\n`;\n      content += `  - Priority: ${sop.priority}\\n`;\n      content += `  - Requirements: ${sop.requirements.length}\\n`;\n    }\n    content += '\\n';\n  }\n\n  content += `## Legend\n\n- üî¨ Requires AI-IRB review\n- Requirements count indicates number of checkable items\n\n## Next Steps\n\n1. Run \\`kg sop check\\` to assess current compliance\n2. Run \\`kg sop gaps\\` to identify remediation needs\n3. Run \\`kg sop report\\` to generate detailed report\n`;\n\n  return content;\n}\n\nfunction generateMarkdownReport(\n  checkResult: ReturnType<typeof checkCompliance> extends Promise<infer T> ? T : never,\n  gapResult: ReturnType<typeof analyzeGaps>,\n  summary: ReturnType<typeof getComplianceSummary>,\n  options: { includeEvidence?: boolean; includeRoadmap?: boolean }\n): string {\n  let report = `---\ntitle: AI-SDLC Compliance Report\ntype: report\ngenerated: ${new Date().toISOString()}\ntags: [compliance, sop, report]\n---\n\n# AI-SDLC Compliance Report\n\n**Project**: ${checkResult.projectName}\n**Generated**: ${checkResult.checkedAt.toISOString()}\n\n## Executive Summary\n\n| Metric | Value |\n|--------|-------|\n| Overall Score | ${checkResult.overallScore}% |\n| Compliant SOPs | ${summary.compliant} |\n| Partial Compliance | ${summary.partial} |\n| Non-Compliant | ${summary.nonCompliant} |\n| Pending Assessment | ${summary.pending} |\n| Total Gaps | ${gapResult.totalGaps} |\n\n## Category Scores\n\n`;\n\n  for (const [category, score] of Object.entries(checkResult.categoryScores)) {\n    if (score > 0) {\n      report += `- **${formatCategory(category as SOPCategory)}**: ${score}%\\n`;\n    }\n  }\n\n  report += `\n## Gap Analysis\n\n### By Priority\n\n| Priority | Count |\n|----------|-------|\n| Critical | ${gapResult.byPriority[SOPPriority.CRITICAL].length} |\n| High | ${gapResult.byPriority[SOPPriority.HIGH].length} |\n| Medium | ${gapResult.byPriority[SOPPriority.MEDIUM].length} |\n| Low | ${gapResult.byPriority[SOPPriority.LOW].length} |\n\n### Effort Breakdown\n\n- Low effort: ${gapResult.summary.totalEffort.low}\n- Medium effort: ${gapResult.summary.totalEffort.medium}\n- High effort: ${gapResult.summary.totalEffort.high}\n\n## Critical Gaps\n\n`;\n\n  if (gapResult.criticalGaps.length > 0) {\n    for (const gap of gapResult.criticalGaps) {\n      const sop = getSOPById(gap.sopId);\n      report += `### ${sop?.title || gap.sopId}\n\n- **Gap ID**: ${gap.id}\n- **Requirement**: ${gap.requirementId}\n- **Priority**: ${gap.priority}\n- **Effort**: ${gap.effort}\n- **Impact**: ${gap.impact}\n\n**Remediation**: ${gap.remediation}\n\n---\n\n`;\n    }\n  } else {\n    report += 'No critical gaps identified.\\n\\n';\n  }\n\n  if (options.includeRoadmap && gapResult.roadmap) {\n    report += `## Remediation Roadmap\n\n`;\n    for (const phase of gapResult.roadmap.phases) {\n      report += `### Phase ${phase.phase}: ${phase.name}\n\n- **Focus**: ${phase.focus}\n- **Effort**: ${phase.effort}\n- **Gaps**: ${phase.gaps.length}\n\n`;\n    }\n  }\n\n  if (options.includeEvidence && checkResult.evidence.length > 0) {\n    report += `## Evidence Found\n\n`;\n    for (const evidence of checkResult.evidence) {\n      report += `- **${evidence.requirementId}**: ${evidence.description}\n  - File: \\`${evidence.filePath}\\`\n  - Confidence: ${Math.round(evidence.confidence * 100)}%\n`;\n    }\n  }\n\n  report += `\n## Recommendations\n\n`;\n\n  // Generate recommendations based on gaps\n  if (gapResult.criticalGaps.length > 0) {\n    report += `1. **Address Critical Gaps Immediately**: ${gapResult.criticalGaps.length} critical gaps require immediate attention.\\n`;\n  }\n\n  if (gapResult.roadmap?.quickWins && gapResult.roadmap.quickWins.length > 0) {\n    report += `2. **Quick Wins**: ${gapResult.roadmap.quickWins.length} high-impact, low-effort improvements available.\\n`;\n  }\n\n  if (checkResult.overallScore < 50) {\n    report += `3. **Compliance Baseline**: Current score of ${checkResult.overallScore}% is below recommended baseline. Focus on foundational SOPs.\\n`;\n  }\n\n  report += `\n---\n\n*Report generated by Knowledge Graph Agent - AI-SDLC SOP Compliance Module*\n`;\n\n  return report;\n}\n\nfunction generateHTMLReport(\n  checkResult: ReturnType<typeof checkCompliance> extends Promise<infer T> ? T : never,\n  gapResult: ReturnType<typeof analyzeGaps>,\n  summary: ReturnType<typeof getComplianceSummary>,\n  options: { includeEvidence?: boolean; includeRoadmap?: boolean }\n): string {\n  return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>AI-SDLC Compliance Report</title>\n  <style>\n    body { font-family: system-ui, sans-serif; max-width: 1200px; margin: 0 auto; padding: 2rem; }\n    .score { font-size: 3rem; font-weight: bold; }\n    .score.high { color: #22c55e; }\n    .score.medium { color: #f59e0b; }\n    .score.low { color: #ef4444; }\n    .card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem; margin: 1rem 0; }\n    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }\n    table { width: 100%; border-collapse: collapse; }\n    th, td { border: 1px solid #e5e7eb; padding: 0.5rem; text-align: left; }\n    th { background: #f9fafb; }\n    .badge { display: inline-block; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.875rem; }\n    .badge.critical { background: #fef2f2; color: #b91c1c; }\n    .badge.high { background: #fff7ed; color: #c2410c; }\n    .badge.medium { background: #fefce8; color: #a16207; }\n    .badge.low { background: #f0fdf4; color: #15803d; }\n  </style>\n</head>\n<body>\n  <h1>AI-SDLC Compliance Report</h1>\n  <p><strong>Project:</strong> ${checkResult.projectName}</p>\n  <p><strong>Generated:</strong> ${checkResult.checkedAt.toISOString()}</p>\n\n  <div class=\"grid\">\n    <div class=\"card\">\n      <h3>Overall Score</h3>\n      <div class=\"score ${checkResult.overallScore >= 70 ? 'high' : checkResult.overallScore >= 50 ? 'medium' : 'low'}\">\n        ${checkResult.overallScore}%\n      </div>\n    </div>\n    <div class=\"card\">\n      <h3>Compliance Status</h3>\n      <p>‚úÖ Compliant: ${summary.compliant}</p>\n      <p>üü° Partial: ${summary.partial}</p>\n      <p>‚ùå Non-compliant: ${summary.nonCompliant}</p>\n    </div>\n    <div class=\"card\">\n      <h3>Gap Summary</h3>\n      <p>Total Gaps: ${gapResult.totalGaps}</p>\n      <p>Critical: ${gapResult.criticalGaps.length}</p>\n      <p>Complexity: ${gapResult.summary.overallComplexity}</p>\n    </div>\n  </div>\n\n  <h2>Category Scores</h2>\n  <table>\n    <tr><th>Category</th><th>Score</th></tr>\n    ${Object.entries(checkResult.categoryScores)\n      .filter(([, score]) => score > 0)\n      .map(([cat, score]) => `<tr><td>${formatCategory(cat as SOPCategory)}</td><td>${score}%</td></tr>`)\n      .join('')}\n  </table>\n\n  <h2>Gaps by Priority</h2>\n  <table>\n    <tr><th>Priority</th><th>Count</th></tr>\n    <tr><td><span class=\"badge critical\">Critical</span></td><td>${gapResult.byPriority[SOPPriority.CRITICAL].length}</td></tr>\n    <tr><td><span class=\"badge high\">High</span></td><td>${gapResult.byPriority[SOPPriority.HIGH].length}</td></tr>\n    <tr><td><span class=\"badge medium\">Medium</span></td><td>${gapResult.byPriority[SOPPriority.MEDIUM].length}</td></tr>\n    <tr><td><span class=\"badge low\">Low</span></td><td>${gapResult.byPriority[SOPPriority.LOW].length}</td></tr>\n  </table>\n\n  ${gapResult.criticalGaps.length > 0 ? `\n  <h2>Critical Gaps</h2>\n  ${gapResult.criticalGaps.map(gap => {\n    const sop = getSOPById(gap.sopId);\n    return `\n    <div class=\"card\">\n      <h3>${sop?.title || gap.sopId}</h3>\n      <p><strong>Gap ID:</strong> ${gap.id}</p>\n      <p><strong>Impact:</strong> ${gap.impact}</p>\n      <p><strong>Remediation:</strong> ${gap.remediation}</p>\n    </div>\n    `;\n  }).join('')}\n  ` : ''}\n\n  <footer style=\"margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; color: #6b7280;\">\n    <p>Generated by Knowledge Graph Agent - AI-SDLC SOP Compliance Module</p>\n  </footer>\n</body>\n</html>`;\n}\n"],"names":["sop"],"mappings":"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"}