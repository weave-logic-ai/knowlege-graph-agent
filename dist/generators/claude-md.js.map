{"version":3,"file":"claude-md.js","sources":["../../src/generators/claude-md.ts"],"sourcesContent":["/**\n * CLAUDE.md Generator\n *\n * Generates and manages CLAUDE.md configuration files for Claude Code\n * with knowledge graph integration.\n *\n * SECURITY NOTES (Handlebars Templates):\n * - All templates use double-braces {{}} which HTML-escapes output\n * - Triple-braces {{{raw}}} are NOT used, preventing XSS in HTML contexts\n * - User input is sanitized via sanitizeTemplateInput() before template use\n * - Template content is validated and Handlebars delimiters are stripped from user input\n * - See: https://handlebarsjs.com/guide/#html-escaping\n */\n\nimport { existsSync, readFileSync, writeFileSync } from 'fs';\nimport { join, basename, resolve, normalize } from 'path';\nimport Handlebars from 'handlebars';\nimport type {\n  ClaudeMdGeneratorOptions,\n  ClaudeMdSection,\n  ClaudeMdTemplate,\n} from '../core/types.js';\n\n/**\n * Validate that a template path is within the project directory\n * and is a markdown file\n */\nfunction validateTemplatePath(projectRoot: string, templatePath: string): string | null {\n  // Resolve both paths to absolute\n  const resolvedRoot = resolve(projectRoot);\n  const resolvedTemplate = resolve(projectRoot, templatePath);\n  const normalizedTemplate = normalize(resolvedTemplate);\n\n  // Ensure template is within project directory\n  if (!normalizedTemplate.startsWith(resolvedRoot + '/') && normalizedTemplate !== resolvedRoot) {\n    return null; // Path traversal attempt\n  }\n\n  // Must be a markdown file\n  if (!normalizedTemplate.endsWith('.md')) {\n    return null;\n  }\n\n  return normalizedTemplate;\n}\n\n/**\n * Default CLAUDE.md template with knowledge graph integration\n */\nconst DEFAULT_TEMPLATE = `# Claude Code Configuration - {{projectName}}\n\n## Project Overview\n\n{{description}}\n\n## Knowledge Graph Integration\n\nThis project uses @weavelogic/knowledge-graph-agent for documentation and planning.\n\n### Quick Commands\n\n\\`\\`\\`bash\n# Initialize knowledge graph\nnpx kg init\n\n# Generate/update graph from docs\nnpx kg graph\n\n# Sync with claude-flow memory\nnpx kg sync\n\n# Initialize docs directory\nnpx kg docs init\n\n# Update CLAUDE.md\nnpx kg claude update\n\\`\\`\\`\n\n### Vault Location\n\nDocumentation is stored in: \\`{{docsPath}}\\`\n\n## File Organization\n\n{{#if customDirectories}}\n{{#each customDirectories}}\n- \\`{{this.path}}\\` - {{this.description}}\n{{/each}}\n{{else}}\n- \\`/src\\` - Source code files\n- \\`/docs\\` - Documentation and knowledge base\n- \\`/tests\\` - Test files\n- \\`/config\\` - Configuration files\n{{/if}}\n\n## Build Commands\n\n{{#each buildCommands}}\n- \\`{{this.command}}\\` - {{this.description}}\n{{/each}}\n\n## Code Style & Best Practices\n\n{{#each codeStyleRules}}\n- **{{this.name}}**: {{this.description}}\n{{/each}}\n\n{{#if includeClaudeFlow}}\n## Claude-Flow Integration\n\nThis project uses claude-flow for AI coordination:\n\n### MCP Configuration\n\n\\`\\`\\`bash\nclaude mcp add claude-flow npx claude-flow@alpha mcp start\n\\`\\`\\`\n\n### Memory Namespace\n\n- **Namespace**: \\`{{namespace}}\\`\n- **Sync on change**: {{syncOnChange}}\n\n### Available Tools\n\n- \\`mcp__claude-flow__memory_usage\\` - Store/retrieve knowledge\n- \\`mcp__claude-flow__swarm_init\\` - Initialize agent swarms\n- \\`mcp__claude-flow__task_orchestrate\\` - Coordinate tasks\n\n{{/if}}\n{{#if includeKnowledgeGraph}}\n## Knowledge Graph Commands\n\nThe knowledge graph provides semantic navigation of the codebase:\n\n### CLI Commands\n\n| Command | Description |\n|---------|-------------|\n| \\`kg init\\` | Initialize knowledge graph in project |\n| \\`kg graph\\` | Generate/update knowledge graph |\n| \\`kg docs init\\` | Initialize docs directory |\n| \\`kg docs generate\\` | Generate docs from codebase |\n| \\`kg claude update\\` | Update CLAUDE.md |\n| \\`kg sync\\` | Sync with claude-flow memory |\n| \\`kg stats\\` | Show graph statistics |\n| \\`kg search <query>\\` | Search the knowledge graph |\n\n### Graph Structure\n\n\\`\\`\\`\n{{docsPath}}/\n├── concepts/        # Abstract concepts\n├── components/      # Reusable components\n├── services/        # Backend services\n├── features/        # Product features\n├── integrations/    # External integrations\n├── standards/       # Coding standards\n├── guides/          # How-to guides\n└── references/      # API references\n\\`\\`\\`\n\n{{/if}}\n{{#if customSections}}\n{{#each customSections}}\n## {{this.title}}\n\n{{this.content}}\n\n{{/each}}\n{{/if}}\n## Important Instructions\n\n- NEVER create files unless absolutely necessary\n- ALWAYS prefer editing existing files\n- Use the knowledge graph for documentation\n- Follow the file organization above\n- Run tests before committing\n\n---\n*Generated by @weavelogic/knowledge-graph-agent*\n`;\n\n/**\n * Section templates for common configurations\n */\nconst SECTION_TEMPLATES: Record<string, ClaudeMdSection> = {\n  sparc: {\n    title: 'SPARC Methodology',\n    order: 10,\n    content: `This project follows the SPARC development methodology:\n\n1. **Specification** - Requirements analysis\n2. **Pseudocode** - Algorithm design\n3. **Architecture** - System design\n4. **Refinement** - TDD implementation\n5. **Completion** - Integration\n\n### SPARC Commands\n\n\\`\\`\\`bash\nnpx claude-flow sparc modes        # List available modes\nnpx claude-flow sparc tdd \"<task>\" # Run TDD workflow\nnpx claude-flow sparc run <mode>   # Execute specific mode\n\\`\\`\\``,\n  },\n\n  testing: {\n    title: 'Testing Requirements',\n    order: 20,\n    content: `All code changes must include appropriate tests:\n\n- **Unit tests**: For individual functions and components\n- **Integration tests**: For API endpoints and services\n- **E2E tests**: For critical user flows\n\n### Running Tests\n\n\\`\\`\\`bash\nnpm run test         # Run all tests\nnpm run test:watch   # Watch mode\nnpm run test:cov     # With coverage\n\\`\\`\\``,\n  },\n\n  security: {\n    title: 'Security Guidelines',\n    order: 30,\n    content: `Security is a priority. Follow these guidelines:\n\n- Never hardcode secrets or API keys\n- Use environment variables for sensitive data\n- Validate all user inputs\n- Sanitize outputs to prevent XSS\n- Follow OWASP guidelines`,\n  },\n\n  agents: {\n    title: 'Available Agents',\n    order: 40,\n    content: `Use Claude Code's Task tool to spawn specialized agents:\n\n### Core Agents\n\\`coder\\`, \\`reviewer\\`, \\`tester\\`, \\`planner\\`, \\`researcher\\`\n\n### SPARC Agents\n\\`sparc-coord\\`, \\`sparc-coder\\`, \\`specification\\`, \\`architecture\\`\n\n### Specialized Agents\n\\`backend-dev\\`, \\`system-architect\\`, \\`code-analyzer\\`, \\`api-docs\\`\n\n### Usage\n\n\\`\\`\\`javascript\nTask(\"Implement feature\", \"Description...\", \"coder\")\nTask(\"Review code\", \"Description...\", \"reviewer\")\n\\`\\`\\``,\n  },\n};\n\n/**\n * Generate CLAUDE.md content\n */\nexport function generateClaudeMd(options: ClaudeMdGeneratorOptions): string {\n  const {\n    projectRoot,\n    template,\n    includeKnowledgeGraph = true,\n    includeClaudeFlow = true,\n    customSections = [],\n  } = options;\n\n  // Detect project info\n  const projectInfo = detectProjectInfo(projectRoot);\n\n  // Prepare context\n  const context = {\n    projectName: projectInfo.name,\n    description: projectInfo.description || `${projectInfo.name} project`,\n    docsPath: getDocsPath(projectRoot),\n    includeKnowledgeGraph,\n    includeClaudeFlow,\n    namespace: 'knowledge-graph',\n    syncOnChange: true,\n    buildCommands: projectInfo.scripts,\n    codeStyleRules: getDefaultCodeStyleRules(),\n    customSections: [...customSections],\n    customDirectories: null,\n  };\n\n  // Get template content (pass projectRoot for path validation)\n  const templateContent = template ? getTemplateContent(template, projectRoot) : DEFAULT_TEMPLATE;\n\n  // Compile and render\n  const compiled = Handlebars.compile(templateContent);\n  return compiled(context);\n}\n\n/**\n * Create or update CLAUDE.md file\n */\nexport async function updateClaudeMd(options: ClaudeMdGeneratorOptions): Promise<{\n  created: boolean;\n  updated: boolean;\n  path: string;\n  content: string;\n}> {\n  const { projectRoot, outputPath } = options;\n  const filePath = outputPath || join(projectRoot, 'CLAUDE.md');\n\n  const exists = existsSync(filePath);\n  const content = generateClaudeMd(options);\n\n  writeFileSync(filePath, content, 'utf-8');\n\n  return {\n    created: !exists,\n    updated: exists,\n    path: filePath,\n    content,\n  };\n}\n\n/**\n * Add section to existing CLAUDE.md\n */\nexport function addSection(\n  projectRoot: string,\n  section: ClaudeMdSection\n): boolean {\n  const filePath = join(projectRoot, 'CLAUDE.md');\n\n  if (!existsSync(filePath)) {\n    return false;\n  }\n\n  const content = readFileSync(filePath, 'utf-8');\n\n  // Check if section already exists\n  const sectionRegex = new RegExp(`^## ${section.title}`, 'm');\n  if (sectionRegex.test(content)) {\n    return false; // Section already exists\n  }\n\n  // Find the best position to insert (before Important Instructions or at end)\n  const importantMatch = content.match(/^## Important Instructions/m);\n  let newContent: string;\n\n  const sectionContent = `\\n## ${section.title}\\n\\n${section.content}\\n`;\n\n  if (importantMatch && importantMatch.index !== undefined) {\n    newContent =\n      content.slice(0, importantMatch.index) +\n      sectionContent +\n      '\\n' +\n      content.slice(importantMatch.index);\n  } else {\n    newContent = content + sectionContent;\n  }\n\n  writeFileSync(filePath, newContent, 'utf-8');\n  return true;\n}\n\n/**\n * Get predefined section template\n */\nexport function getSectionTemplate(name: string): ClaudeMdSection | null {\n  return SECTION_TEMPLATES[name] || null;\n}\n\n/**\n * List available section templates\n */\nexport function listSectionTemplates(): string[] {\n  return Object.keys(SECTION_TEMPLATES);\n}\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\ninterface ProjectInfo {\n  name: string;\n  description?: string;\n  scripts: Array<{ command: string; description: string }>;\n}\n\n/**\n * Sanitize string for safe template use\n * Prevents template injection and removes dangerous characters\n */\nfunction sanitizeForTemplate(str: string | undefined, maxLength = 200): string {\n  if (!str || typeof str !== 'string') return '';\n  return str\n    .replace(/[<>&\"'`{}\\\\]/g, '') // Remove template-sensitive chars\n    .replace(/\\{\\{/g, '')  // Remove Handlebars delimiters\n    .replace(/\\}\\}/g, '')\n    .slice(0, maxLength)\n    .trim();\n}\n\nfunction detectProjectInfo(projectRoot: string): ProjectInfo {\n  const info: ProjectInfo = {\n    name: sanitizeForTemplate(basename(projectRoot), 100) || 'project',\n    scripts: [],\n  };\n\n  try {\n    const pkgPath = join(projectRoot, 'package.json');\n    if (existsSync(pkgPath)) {\n      let pkg;\n      try {\n        pkg = JSON.parse(readFileSync(pkgPath, 'utf-8'));\n      } catch {\n        return info; // Return default info on JSON parse error\n      }\n\n      // Sanitize project name\n      const rawName = (pkg.name || basename(projectRoot)).replace(/^@[^/]+\\//, '');\n      info.name = sanitizeForTemplate(rawName, 100) || 'project';\n\n      // Sanitize description\n      info.description = sanitizeForTemplate(pkg.description, 500);\n\n      // Extract common scripts (sanitize script names)\n      if (pkg.scripts && typeof pkg.scripts === 'object') {\n        const commonScripts = ['build', 'test', 'dev', 'start', 'lint', 'typecheck'];\n        for (const script of commonScripts) {\n          if (pkg.scripts[script] && typeof pkg.scripts[script] === 'string') {\n            info.scripts.push({\n              command: `npm run ${script}`,\n              description: sanitizeForTemplate(\n                getScriptDescription(script, pkg.scripts[script]),\n                200\n              ),\n            });\n          }\n        }\n      }\n    }\n  } catch {\n    // Ignore errors - return default info\n  }\n\n  // Add default scripts if none found\n  if (info.scripts.length === 0) {\n    info.scripts = [\n      { command: 'npm run build', description: 'Build the project' },\n      { command: 'npm run test', description: 'Run tests' },\n      { command: 'npm run dev', description: 'Development mode' },\n    ];\n  }\n\n  return info;\n}\n\nfunction getScriptDescription(name: string, script: string): string {\n  const descriptions: Record<string, string> = {\n    build: 'Build the project',\n    test: 'Run tests',\n    dev: 'Start development server',\n    start: 'Start production server',\n    lint: 'Run linter',\n    typecheck: 'Type checking',\n  };\n\n  return descriptions[name] || `Run ${name}`;\n}\n\nfunction getDocsPath(projectRoot: string): string {\n  const possiblePaths = ['docs', 'documentation', 'doc'];\n\n  for (const path of possiblePaths) {\n    if (existsSync(join(projectRoot, path))) {\n      return path;\n    }\n  }\n\n  return 'docs';\n}\n\nfunction getDefaultCodeStyleRules(): Array<{ name: string; description: string }> {\n  return [\n    { name: 'Modular Design', description: 'Files under 500 lines' },\n    { name: 'Environment Safety', description: 'Never hardcode secrets' },\n    { name: 'Test-First', description: 'Write tests before implementation' },\n    { name: 'Clean Architecture', description: 'Separate concerns' },\n    { name: 'Documentation', description: 'Keep docs updated' },\n  ];\n}\n\nfunction getTemplateContent(templateName: string, projectRoot?: string): string {\n  // Check for built-in templates\n  if (templateName === 'minimal') {\n    return `# {{projectName}}\n\n{{description}}\n\n## Commands\n\n{{#each buildCommands}}\n- \\`{{this.command}}\\` - {{this.description}}\n{{/each}}\n\n---\n*Generated by @weavelogic/knowledge-graph-agent*\n`;\n  }\n\n  if (templateName === 'full') {\n    // Add all sections\n    let content = DEFAULT_TEMPLATE;\n    for (const section of Object.values(SECTION_TEMPLATES)) {\n      content = content.replace(\n        /^## Important Instructions/m,\n        `## ${section.title}\\n\\n${section.content}\\n\\n## Important Instructions`\n      );\n    }\n    return content;\n  }\n\n  // Try to read as file path - only if within project directory\n  if (projectRoot && (templateName.includes('/') || templateName.includes('.'))) {\n    const validatedPath = validateTemplatePath(projectRoot, templateName);\n    if (validatedPath && existsSync(validatedPath)) {\n      return readFileSync(validatedPath, 'utf-8');\n    }\n  }\n\n  return DEFAULT_TEMPLATE;\n}\n"],"names":[],"mappings":"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"}