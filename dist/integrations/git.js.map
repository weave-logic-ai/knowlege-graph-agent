{"version":3,"file":"git.js","sources":["../../src/integrations/git.ts"],"sourcesContent":["/**\n * Git Integration\n *\n * Provides Git operations for the knowledge graph agent using simple-git.\n *\n * @module integrations/git\n */\n\nimport simpleGit, {\n  SimpleGit,\n  StatusResult,\n  DiffResult,\n  LogResult,\n  DefaultLogFields,\n} from 'simple-git';\nimport { createLogger, Logger, KnowledgeGraphError, ErrorCategory, ErrorSeverity } from '../utils/index.js';\n\n/**\n * Git client configuration\n */\nexport interface GitClientConfig {\n  /** Working directory for git operations */\n  workingDirectory?: string;\n  /** Logger instance */\n  logger?: Logger;\n  /** Timeout for git operations in milliseconds */\n  timeout?: number;\n}\n\n/**\n * Git status summary\n */\nexport interface GitStatusSummary {\n  /** Current branch name */\n  branch: string;\n  /** Whether the repository is clean */\n  isClean: boolean;\n  /** Number of staged files */\n  staged: number;\n  /** Number of modified files */\n  modified: number;\n  /** Number of untracked files */\n  untracked: number;\n  /** Number of deleted files */\n  deleted: number;\n  /** Number of renamed files */\n  renamed: number;\n  /** Number of conflicted files */\n  conflicted: number;\n  /** Tracking information */\n  tracking?: {\n    ahead: number;\n    behind: number;\n    remote?: string;\n  };\n  /** List of changed files */\n  files: GitFileStatus[];\n}\n\n/**\n * Individual file status\n */\nexport interface GitFileStatus {\n  /** File path */\n  path: string;\n  /** Index status (staged) */\n  indexStatus: string;\n  /** Working tree status */\n  workingTreeStatus: string;\n  /** Whether the file is staged */\n  isStaged: boolean;\n}\n\n/**\n * Git diff summary\n */\nexport interface GitDiffSummary {\n  /** Number of changed files */\n  changed: number;\n  /** Number of insertions */\n  insertions: number;\n  /** Number of deletions */\n  deletions: number;\n  /** List of changed files with details */\n  files: GitDiffFile[];\n}\n\n/**\n * Git diff file details\n */\nexport interface GitDiffFile {\n  /** File path */\n  file: string;\n  /** Number of insertions */\n  insertions: number;\n  /** Number of deletions */\n  deletions: number;\n  /** Whether the file is binary */\n  binary: boolean;\n}\n\n/**\n * Git commit info\n */\nexport interface GitCommitInfo {\n  /** Commit hash */\n  hash: string;\n  /** Abbreviated commit hash */\n  hashAbbrev: string;\n  /** Author name */\n  author: string;\n  /** Author email */\n  email: string;\n  /** Commit date */\n  date: Date;\n  /** Commit message */\n  message: string;\n  /** Commit body */\n  body?: string;\n  /** Parent commit hashes */\n  parents: string[];\n}\n\n/**\n * Git remote info\n */\nexport interface GitRemoteInfo {\n  /** Remote name */\n  name: string;\n  /** Fetch URL */\n  fetchUrl: string;\n  /** Push URL */\n  pushUrl: string;\n}\n\n/**\n * Git branch info\n */\nexport interface GitBranchInfo {\n  /** Current branch name */\n  current: string;\n  /** Whether the branch is detached */\n  detached: boolean;\n  /** All local branches */\n  local: string[];\n  /** All remote branches */\n  remote: string[];\n}\n\n/**\n * Git commit options\n */\nexport interface GitCommitOptions {\n  /** Commit message */\n  message: string;\n  /** Whether to amend the previous commit */\n  amend?: boolean;\n  /** Whether to allow empty commits */\n  allowEmpty?: boolean;\n  /** Specific files to commit (all staged if empty) */\n  files?: string[];\n  /** Author override */\n  author?: {\n    name: string;\n    email: string;\n  };\n}\n\n/**\n * Git commit result\n */\nexport interface GitCommitResult {\n  /** Whether the commit was successful */\n  success: boolean;\n  /** Commit hash */\n  hash?: string;\n  /** Branch name */\n  branch?: string;\n  /** Commit summary */\n  summary?: {\n    changes: number;\n    insertions: number;\n    deletions: number;\n  };\n  /** Error message if failed */\n  error?: string;\n}\n\n/**\n * Git error class\n */\nexport class GitError extends KnowledgeGraphError {\n  public readonly gitCommand?: string;\n  public readonly gitOutput?: string;\n\n  constructor(\n    message: string,\n    gitCommand?: string,\n    gitOutput?: string\n  ) {\n    super(message, {\n      category: ErrorCategory.RESOURCE,\n      severity: ErrorSeverity.ERROR,\n      retryable: false,\n      code: 'GIT_ERROR',\n      context: { gitCommand, gitOutput },\n    });\n    this.name = 'GitError';\n    this.gitCommand = gitCommand;\n    this.gitOutput = gitOutput;\n  }\n}\n\n/**\n * Git Client\n *\n * Provides a high-level interface for Git operations.\n */\nexport class GitClient {\n  private git: SimpleGit;\n  private logger: Logger;\n  private workingDirectory: string;\n\n  constructor(config: GitClientConfig = {}) {\n    this.workingDirectory = config.workingDirectory || process.cwd();\n    this.logger = config.logger || createLogger('git');\n\n    this.git = simpleGit({\n      baseDir: this.workingDirectory,\n      binary: 'git',\n      maxConcurrentProcesses: 6,\n      timeout: {\n        block: config.timeout || 30000,\n      },\n    });\n  }\n\n  /**\n   * Check if the current directory is a git repository\n   */\n  async isRepo(): Promise<boolean> {\n    try {\n      await this.git.revparse(['--git-dir']);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Get the current git status\n   */\n  async getStatus(): Promise<GitStatusSummary> {\n    try {\n      const status: StatusResult = await this.git.status();\n\n      const files: GitFileStatus[] = status.files.map(f => ({\n        path: f.path,\n        indexStatus: f.index || ' ',\n        workingTreeStatus: f.working_dir || ' ',\n        isStaged: f.index !== ' ' && f.index !== '?',\n      }));\n\n      return {\n        branch: status.current || 'HEAD',\n        isClean: status.isClean(),\n        staged: status.staged.length,\n        modified: status.modified.length,\n        untracked: status.not_added.length,\n        deleted: status.deleted.length,\n        renamed: status.renamed.length,\n        conflicted: status.conflicted.length,\n        tracking: status.tracking\n          ? {\n              ahead: status.ahead,\n              behind: status.behind,\n              remote: status.tracking,\n            }\n          : undefined,\n        files,\n      };\n    } catch (error) {\n      throw new GitError(\n        `Failed to get git status: ${error instanceof Error ? error.message : String(error)}`,\n        'git status',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Get the diff of changes\n   */\n  async getDiff(options: {\n    staged?: boolean;\n    file?: string;\n    cached?: boolean;\n  } = {}): Promise<GitDiffSummary> {\n    try {\n      const args: string[] = ['--stat'];\n\n      if (options.staged || options.cached) {\n        args.push('--cached');\n      }\n\n      if (options.file) {\n        args.push('--', options.file);\n      }\n\n      const diffResult: DiffResult = await this.git.diffSummary(args);\n\n      return {\n        changed: diffResult.changed,\n        insertions: diffResult.insertions,\n        deletions: diffResult.deletions,\n        files: diffResult.files.map(f => ({\n          file: f.file,\n          insertions: 'insertions' in f ? f.insertions : 0,\n          deletions: 'deletions' in f ? f.deletions : 0,\n          binary: f.binary,\n        })),\n      };\n    } catch (error) {\n      throw new GitError(\n        `Failed to get diff: ${error instanceof Error ? error.message : String(error)}`,\n        'git diff',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Get the full diff content\n   */\n  async getDiffContent(options: {\n    staged?: boolean;\n    file?: string;\n  } = {}): Promise<string> {\n    try {\n      const args: string[] = [];\n\n      if (options.staged) {\n        args.push('--cached');\n      }\n\n      if (options.file) {\n        args.push('--', options.file);\n      }\n\n      return await this.git.diff(args);\n    } catch (error) {\n      throw new GitError(\n        `Failed to get diff content: ${error instanceof Error ? error.message : String(error)}`,\n        'git diff',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Stage files for commit\n   */\n  async add(files: string[] | string = '.'): Promise<void> {\n    try {\n      const fileList = Array.isArray(files) ? files : [files];\n      await this.git.add(fileList);\n      this.logger.debug('Staged files', { files: fileList });\n    } catch (error) {\n      throw new GitError(\n        `Failed to stage files: ${error instanceof Error ? error.message : String(error)}`,\n        'git add',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Unstage files\n   */\n  async reset(files: string[] | string): Promise<void> {\n    try {\n      const fileList = Array.isArray(files) ? files : [files];\n      await this.git.reset(['HEAD', '--', ...fileList]);\n      this.logger.debug('Unstaged files', { files: fileList });\n    } catch (error) {\n      throw new GitError(\n        `Failed to unstage files: ${error instanceof Error ? error.message : String(error)}`,\n        'git reset',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Create a commit\n   */\n  async commit(options: GitCommitOptions): Promise<GitCommitResult> {\n    try {\n      const commitArgs: string[] = [];\n\n      if (options.amend) {\n        commitArgs.push('--amend');\n      }\n\n      if (options.allowEmpty) {\n        commitArgs.push('--allow-empty');\n      }\n\n      if (options.author) {\n        commitArgs.push(`--author=\"${options.author.name} <${options.author.email}>\"`);\n      }\n\n      // Handle specific files\n      if (options.files && options.files.length > 0) {\n        await this.add(options.files);\n      }\n\n      const result = await this.git.commit(options.message, undefined, {\n        '--message': options.message,\n      });\n\n      this.logger.info('Created commit', {\n        hash: result.commit,\n        branch: result.branch,\n      });\n\n      return {\n        success: true,\n        hash: result.commit,\n        branch: result.branch,\n        summary: {\n          changes: result.summary.changes,\n          insertions: result.summary.insertions,\n          deletions: result.summary.deletions,\n        },\n      };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      this.logger.error('Failed to create commit', new Error(errorMessage));\n\n      return {\n        success: false,\n        error: errorMessage,\n      };\n    }\n  }\n\n  /**\n   * Get commit log\n   */\n  async getLog(options: {\n    maxCount?: number;\n    file?: string;\n    since?: Date;\n    until?: Date;\n    author?: string;\n  } = {}): Promise<GitCommitInfo[]> {\n    try {\n      // Build log options as simple-git expects\n      const logArgs: string[] = [];\n\n      if (options.maxCount) {\n        logArgs.push(`-n${options.maxCount}`);\n      }\n\n      if (options.since) {\n        logArgs.push(`--since=${options.since.toISOString()}`);\n      }\n\n      if (options.until) {\n        logArgs.push(`--until=${options.until.toISOString()}`);\n      }\n\n      if (options.author) {\n        logArgs.push(`--author=${options.author}`);\n      }\n\n      if (options.file) {\n        logArgs.push('--', options.file);\n      }\n\n      const log: LogResult<DefaultLogFields> = await this.git.log(logArgs);\n\n      return log.all.map(entry => ({\n        hash: entry.hash,\n        hashAbbrev: entry.hash.substring(0, 7),\n        author: entry.author_name,\n        email: entry.author_email,\n        date: new Date(entry.date),\n        message: entry.message,\n        body: entry.body || undefined,\n        parents: entry.refs ? entry.refs.split(',').map(r => r.trim()) : [],\n      }));\n    } catch (error) {\n      throw new GitError(\n        `Failed to get log: ${error instanceof Error ? error.message : String(error)}`,\n        'git log',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Get current branch information\n   */\n  async getBranch(): Promise<GitBranchInfo> {\n    try {\n      const branchSummary = await this.git.branch(['-a']);\n\n      const local: string[] = [];\n      const remote: string[] = [];\n\n      for (const [name, branch] of Object.entries(branchSummary.branches)) {\n        if (name.startsWith('remotes/')) {\n          remote.push(name.replace('remotes/', ''));\n        } else {\n          local.push(name);\n        }\n      }\n\n      return {\n        current: branchSummary.current,\n        detached: branchSummary.detached,\n        local,\n        remote,\n      };\n    } catch (error) {\n      throw new GitError(\n        `Failed to get branch info: ${error instanceof Error ? error.message : String(error)}`,\n        'git branch',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Get remote information\n   */\n  async getRemotes(): Promise<GitRemoteInfo[]> {\n    try {\n      const remotes = await this.git.getRemotes(true);\n\n      return remotes.map(remote => ({\n        name: remote.name,\n        fetchUrl: remote.refs.fetch || '',\n        pushUrl: remote.refs.push || '',\n      }));\n    } catch (error) {\n      throw new GitError(\n        `Failed to get remotes: ${error instanceof Error ? error.message : String(error)}`,\n        'git remote',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Push to remote\n   */\n  async push(options: {\n    remote?: string;\n    branch?: string;\n    setUpstream?: boolean;\n    force?: boolean;\n  } = {}): Promise<void> {\n    try {\n      const remote = options.remote || 'origin';\n      const args: string[] = [];\n\n      if (options.setUpstream) {\n        args.push('-u');\n      }\n\n      if (options.force) {\n        args.push('--force');\n      }\n\n      args.push(remote);\n\n      if (options.branch) {\n        args.push(options.branch);\n      }\n\n      await this.git.push(args);\n      this.logger.info('Pushed to remote', { remote, branch: options.branch });\n    } catch (error) {\n      throw new GitError(\n        `Failed to push: ${error instanceof Error ? error.message : String(error)}`,\n        'git push',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Pull from remote\n   */\n  async pull(options: {\n    remote?: string;\n    branch?: string;\n    rebase?: boolean;\n  } = {}): Promise<void> {\n    try {\n      const remote = options.remote || 'origin';\n      const pullArgs: string[] = [];\n\n      if (options.rebase) {\n        pullArgs.push('--rebase');\n      }\n\n      pullArgs.push(remote);\n\n      if (options.branch) {\n        pullArgs.push(options.branch);\n      }\n\n      await this.git.pull(pullArgs);\n      this.logger.info('Pulled from remote', { remote, branch: options.branch });\n    } catch (error) {\n      throw new GitError(\n        `Failed to pull: ${error instanceof Error ? error.message : String(error)}`,\n        'git pull',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Fetch from remote\n   */\n  async fetch(options: {\n    remote?: string;\n    all?: boolean;\n    prune?: boolean;\n  } = {}): Promise<void> {\n    try {\n      const args: string[] = [];\n\n      if (options.all) {\n        args.push('--all');\n      }\n\n      if (options.prune) {\n        args.push('--prune');\n      }\n\n      if (options.remote) {\n        args.push(options.remote);\n      }\n\n      await this.git.fetch(args);\n      this.logger.debug('Fetched from remote', options);\n    } catch (error) {\n      throw new GitError(\n        `Failed to fetch: ${error instanceof Error ? error.message : String(error)}`,\n        'git fetch',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Stash changes\n   */\n  async stash(options: {\n    message?: string;\n    includeUntracked?: boolean;\n  } = {}): Promise<void> {\n    try {\n      const args: string[] = ['push'];\n\n      if (options.message) {\n        args.push('-m', options.message);\n      }\n\n      if (options.includeUntracked) {\n        args.push('--include-untracked');\n      }\n\n      await this.git.stash(args);\n      this.logger.debug('Stashed changes', options);\n    } catch (error) {\n      throw new GitError(\n        `Failed to stash: ${error instanceof Error ? error.message : String(error)}`,\n        'git stash',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Pop stash\n   */\n  async stashPop(): Promise<void> {\n    try {\n      await this.git.stash(['pop']);\n      this.logger.debug('Popped stash');\n    } catch (error) {\n      throw new GitError(\n        `Failed to pop stash: ${error instanceof Error ? error.message : String(error)}`,\n        'git stash pop',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Get the root directory of the git repository\n   */\n  async getRoot(): Promise<string> {\n    try {\n      const root = await this.git.revparse(['--show-toplevel']);\n      return root.trim();\n    } catch (error) {\n      throw new GitError(\n        `Failed to get repository root: ${error instanceof Error ? error.message : String(error)}`,\n        'git rev-parse',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Get the current HEAD commit hash\n   */\n  async getHead(): Promise<string> {\n    try {\n      const head = await this.git.revparse(['HEAD']);\n      return head.trim();\n    } catch (error) {\n      throw new GitError(\n        `Failed to get HEAD: ${error instanceof Error ? error.message : String(error)}`,\n        'git rev-parse',\n        String(error)\n      );\n    }\n  }\n\n  /**\n   * Check if there are uncommitted changes\n   */\n  async hasUncommittedChanges(): Promise<boolean> {\n    const status = await this.getStatus();\n    return !status.isClean;\n  }\n\n  /**\n   * Get the underlying simple-git instance for advanced operations\n   */\n  getRawClient(): SimpleGit {\n    return this.git;\n  }\n}\n\n/**\n * Create a GitClient instance\n */\nexport function createGitClient(config: GitClientConfig = {}): GitClient {\n  return new GitClient(config);\n}\n"],"names":[],"mappings":"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"}