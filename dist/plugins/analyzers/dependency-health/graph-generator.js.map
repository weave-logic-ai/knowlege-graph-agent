{"version":3,"file":"graph-generator.js","sources":["../../../../src/plugins/analyzers/dependency-health/graph-generator.ts"],"sourcesContent":["/**\n * Knowledge Graph Generator for Dependencies\n *\n * Generates knowledge graph nodes and edges from dependency health analysis.\n * Creates interconnected nodes representing dependencies with health metadata.\n *\n * @module plugins/analyzers/dependency-health/graph-generator\n */\n\nimport { createLogger } from '../../../utils/logger.js';\nimport type { KnowledgeNode, GraphEdge, NodeType } from '../../../core/types.js';\nimport type { DependencyInfo } from '../../../cultivation/types.js';\nimport type {\n  DependencyHealthAnalysis,\n  DependencyHealthScore,\n  DependencyHealthNode,\n  DependencyEdge,\n  NpmPackageMetadata,\n  HealthStatus,\n  VulnerabilitySeverity,\n} from './types.js';\n\nconst logger = createLogger('dependency-graph-generator');\n\n/**\n * Generate a node ID from package name\n */\nfunction generateNodeId(packageName: string): string {\n  return `dep:${packageName.replace(/[@/]/g, '-').replace(/^-/, '')}`;\n}\n\n/**\n * Map health status to node status\n */\nfunction mapHealthToNodeStatus(status: HealthStatus): 'active' | 'deprecated' | 'draft' {\n  switch (status) {\n    case 'healthy':\n      return 'active';\n    case 'critical':\n      return 'deprecated';\n    default:\n      return 'draft';\n  }\n}\n\n/**\n * Generate tags for a dependency\n */\nfunction generateTags(\n  score: DependencyHealthScore,\n  dependency: DependencyInfo\n): string[] {\n  const tags: string[] = ['dependency', dependency.ecosystem];\n\n  if (dependency.isDev) {\n    tags.push('dev-dependency');\n  }\n\n  if (score.status === 'critical') {\n    tags.push('critical-health');\n  } else if (score.status === 'warning') {\n    tags.push('needs-attention');\n  }\n\n  // Add vulnerability tag if applicable\n  if (score.issues.some(i => i.type === 'vulnerability')) {\n    tags.push('has-vulnerabilities');\n  }\n\n  // Add outdated tag if applicable\n  if (score.issues.some(i => i.type === 'outdated')) {\n    tags.push('outdated');\n  }\n\n  // Add deprecated tag if applicable\n  if (score.issues.some(i => i.type === 'deprecated')) {\n    tags.push('deprecated');\n  }\n\n  return tags;\n}\n\n/**\n * DependencyGraphGenerator class\n */\nexport class DependencyGraphGenerator {\n  private projectName: string;\n\n  constructor(projectName: string = 'project') {\n    this.projectName = projectName;\n  }\n\n  /**\n   * Generate knowledge graph nodes from analysis result\n   */\n  generateNodes(analysis: DependencyHealthAnalysis): DependencyHealthNode[] {\n    const nodes: DependencyHealthNode[] = [];\n    const now = new Date().toISOString();\n\n    for (const healthScore of analysis.dependencies) {\n      const nodeId = generateNodeId(healthScore.name);\n\n      const node: DependencyHealthNode = {\n        id: nodeId,\n        type: 'primitive' as NodeType,\n        name: healthScore.name,\n        version: healthScore.version,\n        health: healthScore,\n        dependency: {\n          name: healthScore.name,\n          version: healthScore.version,\n          type: 'library',\n          category: 'dependencies',\n          ecosystem: 'nodejs',\n          usedBy: [],\n          relatedTo: [],\n        },\n        tags: generateTags(healthScore, {\n          name: healthScore.name,\n          version: healthScore.version,\n          type: 'library',\n          category: 'dependencies',\n          ecosystem: 'nodejs',\n          usedBy: [],\n          relatedTo: [],\n        }),\n        warnings: this.generateWarnings(healthScore),\n        createdAt: now,\n        updatedAt: now,\n      };\n\n      nodes.push(node);\n    }\n\n    logger.info('Generated dependency nodes', { count: nodes.length });\n    return nodes;\n  }\n\n  /**\n   * Generate warning metadata from health score\n   */\n  private generateWarnings(score: DependencyHealthScore): DependencyHealthNode['warnings'] {\n    const vulnIssues = score.issues.filter(i => i.type === 'vulnerability');\n    const hasVulns = vulnIssues.length > 0;\n\n    let maxSeverity: VulnerabilitySeverity | undefined;\n    if (hasVulns) {\n      const severities: VulnerabilitySeverity[] = ['critical', 'high', 'moderate', 'low', 'info'];\n      for (const sev of severities) {\n        if (vulnIssues.some(i => i.severity === sev ||\n            (i.data?.maxSeverity && i.data.maxSeverity === sev))) {\n          maxSeverity = sev;\n          break;\n        }\n      }\n    }\n\n    return {\n      hasVulnerabilities: hasVulns,\n      vulnerabilityCount: vulnIssues.length,\n      maxSeverity,\n      isOutdated: score.issues.some(i => i.type === 'outdated'),\n      isDeprecated: score.issues.some(i => i.type === 'deprecated'),\n    };\n  }\n\n  /**\n   * Generate edges representing dependency relationships\n   */\n  generateEdges(\n    nodes: DependencyHealthNode[],\n    packageJsonDeps?: Record<string, string>\n  ): DependencyEdge[] {\n    const edges: DependencyEdge[] = [];\n    const nodeIds = new Set(nodes.map(n => n.id));\n    const projectNodeId = `project:${this.projectName}`;\n\n    // Create edges from project to each dependency\n    for (const node of nodes) {\n      const edge: DependencyEdge = {\n        source: projectNodeId,\n        target: node.id,\n        type: 'link',\n        weight: node.health.status === 'healthy' ? 1.0 :\n                node.health.status === 'warning' ? 0.7 : 0.4,\n        dependencyType: node.tags.includes('dev-dependency') ? 'development' : 'production',\n        versionConstraint: node.version,\n      };\n      edges.push(edge);\n    }\n\n    // Try to infer inter-dependency relationships\n    // This could be enhanced with actual dependency tree analysis\n    for (const node of nodes) {\n      // Find related packages (e.g., @babel/* packages relate to each other)\n      const scopeMatch = node.name.match(/^@([^/]+)\\//);\n      if (scopeMatch) {\n        const scope = scopeMatch[1];\n        for (const otherNode of nodes) {\n          if (otherNode.id !== node.id && otherNode.name.startsWith(`@${scope}/`)) {\n            // Only add one direction to avoid duplicates\n            if (node.name < otherNode.name) {\n              edges.push({\n                source: node.id,\n                target: otherNode.id,\n                type: 'related',\n                weight: 0.5,\n              });\n            }\n          }\n        }\n      }\n    }\n\n    logger.info('Generated dependency edges', { count: edges.length });\n    return edges;\n  }\n\n  /**\n   * Convert DependencyHealthNode to standard KnowledgeNode\n   */\n  toKnowledgeNode(node: DependencyHealthNode): KnowledgeNode {\n    const healthSummary = [\n      `Health Score: ${node.health.overallScore}/100`,\n      `Security: ${node.health.components.security}/100`,\n      `Freshness: ${node.health.components.freshness}/100`,\n      `Maintenance: ${node.health.components.maintenance}/100`,\n    ].join('\\n');\n\n    const issues = node.health.issues.length > 0\n      ? '\\n\\n## Issues\\n' + node.health.issues.map(i => `- [${i.severity}] ${i.message}`).join('\\n')\n      : '';\n\n    const recommendations = node.health.recommendations.length > 0\n      ? '\\n\\n## Recommendations\\n' + node.health.recommendations.map(r => `- ${r}`).join('\\n')\n      : '';\n\n    const content = `# ${node.name}\n\n**Version:** ${node.version}\n**Status:** ${node.health.status}\n\n## Health Metrics\n\n${healthSummary}\n${issues}\n${recommendations}\n`;\n\n    return {\n      id: node.id,\n      path: `dependencies/${node.name.replace(/[@/]/g, '-')}.md`,\n      filename: `${node.name.replace(/[@/]/g, '-')}.md`,\n      title: node.name,\n      type: node.type,\n      status: mapHealthToNodeStatus(node.health.status),\n      content,\n      frontmatter: {\n        title: node.name,\n        type: node.type,\n        status: mapHealthToNodeStatus(node.health.status),\n        tags: node.tags,\n        category: 'dependencies',\n        version: node.version,\n        healthScore: node.health.overallScore,\n        hasVulnerabilities: node.warnings?.hasVulnerabilities,\n        isOutdated: node.warnings?.isOutdated,\n        created: node.createdAt,\n        updated: node.updatedAt,\n      },\n      tags: node.tags,\n      outgoingLinks: [],\n      incomingLinks: [],\n      wordCount: content.split(/\\s+/).length,\n      lastModified: new Date(node.updatedAt),\n    };\n  }\n\n  /**\n   * Convert GraphEdge to standard format\n   */\n  toGraphEdge(edge: DependencyEdge): GraphEdge {\n    return {\n      source: edge.source,\n      target: edge.target,\n      type: edge.type,\n      weight: edge.weight,\n      context: edge.dependencyType,\n    };\n  }\n\n  /**\n   * Generate full graph structure\n   */\n  generateGraph(analysis: DependencyHealthAnalysis): {\n    nodes: KnowledgeNode[];\n    edges: GraphEdge[];\n    metadata: {\n      totalDependencies: number;\n      averageHealthScore: number;\n      vulnerableCount: number;\n      outdatedCount: number;\n      analyzedAt: string;\n    };\n  } {\n    const healthNodes = this.generateNodes(analysis);\n    const healthEdges = this.generateEdges(healthNodes);\n\n    return {\n      nodes: healthNodes.map(n => this.toKnowledgeNode(n)),\n      edges: healthEdges.map(e => this.toGraphEdge(e)),\n      metadata: {\n        totalDependencies: analysis.totalDependencies,\n        averageHealthScore: analysis.summary.averageHealthScore,\n        vulnerableCount: analysis.summary.vulnerabilities.total,\n        outdatedCount: analysis.summary.outdated.total,\n        analyzedAt: analysis.analyzedAt,\n      },\n    };\n  }\n\n  /**\n   * Generate markdown summary of dependency health\n   */\n  generateMarkdownReport(analysis: DependencyHealthAnalysis): string {\n    const lines: string[] = [\n      '# Dependency Health Report',\n      '',\n      `Generated: ${analysis.analyzedAt}`,\n      `Project: ${analysis.projectRoot}`,\n      '',\n      '## Summary',\n      '',\n      `- **Total Dependencies:** ${analysis.totalDependencies}`,\n      `- **Average Health Score:** ${analysis.summary.averageHealthScore}/100`,\n      `- **Healthy:** ${analysis.summary.healthScores.healthy}`,\n      `- **Warning:** ${analysis.summary.healthScores.warning}`,\n      `- **Critical:** ${analysis.summary.healthScores.critical}`,\n      '',\n      '### Vulnerabilities',\n      '',\n      `- Critical: ${analysis.summary.vulnerabilities.critical}`,\n      `- High: ${analysis.summary.vulnerabilities.high}`,\n      `- Moderate: ${analysis.summary.vulnerabilities.moderate}`,\n      `- Low: ${analysis.summary.vulnerabilities.low}`,\n      '',\n      '### Outdated Packages',\n      '',\n      `- Major updates: ${analysis.summary.outdated.major}`,\n      `- Minor updates: ${analysis.summary.outdated.minor}`,\n      `- Patch updates: ${analysis.summary.outdated.patch}`,\n      '',\n    ];\n\n    // Add critical issues section\n    const criticalDeps = analysis.dependencies.filter(d => d.status === 'critical');\n    if (criticalDeps.length > 0) {\n      lines.push('## Critical Issues', '');\n      for (const dep of criticalDeps) {\n        lines.push(`### ${dep.name} (Score: ${dep.overallScore})`);\n        lines.push('');\n        for (const issue of dep.issues) {\n          lines.push(`- **[${issue.severity.toUpperCase()}]** ${issue.message}`);\n        }\n        if (dep.recommendations.length > 0) {\n          lines.push('');\n          lines.push('**Recommendations:**');\n          for (const rec of dep.recommendations) {\n            lines.push(`- ${rec}`);\n          }\n        }\n        lines.push('');\n      }\n    }\n\n    // Add warning section\n    const warningDeps = analysis.dependencies.filter(d => d.status === 'warning');\n    if (warningDeps.length > 0) {\n      lines.push('## Needs Attention', '');\n      for (const dep of warningDeps.slice(0, 10)) { // Limit to top 10\n        lines.push(`- **${dep.name}** (Score: ${dep.overallScore}): ${dep.issues[0]?.message ?? 'Various issues'}`);\n      }\n      if (warningDeps.length > 10) {\n        lines.push(`- ... and ${warningDeps.length - 10} more`);\n      }\n      lines.push('');\n    }\n\n    return lines.join('\\n');\n  }\n}\n\n/**\n * Create a dependency graph generator instance\n */\nexport function createDependencyGraphGenerator(projectName?: string): DependencyGraphGenerator {\n  return new DependencyGraphGenerator(projectName);\n}\n"],"names":[],"mappings":"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"}