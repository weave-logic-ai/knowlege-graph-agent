{"version":3,"file":"validate-names.js","sources":["../../../../src/cli/commands/hive-mind/validate-names.ts"],"sourcesContent":["/**\n * Hive Mind - Name Validator\n *\n * Validates file naming schema in a vault to ensure consistent, linkable names.\n * Supports kebab-case, lowercase, and other naming conventions.\n *\n * SPEC-003: Hive Mind Reconnection Tools\n */\n\nimport { Command } from 'commander';\nimport chalk from 'chalk';\nimport * as path from 'path';\nimport { readdir, rename, access, mkdir, writeFile } from 'fs/promises';\nimport { glob } from 'fast-glob';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface ValidateNamesOptions {\n  fix?: boolean;\n  dryRun?: boolean;\n  schema?: string;\n  output?: string;\n  json?: boolean;\n  verbose?: boolean;\n}\n\nexport interface InvalidFile {\n  file: string;\n  issues: string[];\n  suggested: string;\n}\n\nexport interface ValidationResult {\n  valid: string[];\n  invalid: InvalidFile[];\n  statistics: {\n    totalFiles: number;\n    validCount: number;\n    invalidCount: number;\n    commonIssues: Map<string, number>;\n  };\n}\n\nexport interface NamingSchema {\n  name: string;\n  patterns: {\n    lowercase: boolean;\n    separator: '-' | '_' | '.';\n    maxLength: number;\n    allowedChars: RegExp;\n    reservedNames: string[];\n    allowMixedSeparators?: boolean;\n  };\n}\n\n// ============================================================================\n// Predefined Schemas\n// ============================================================================\n\nconst SCHEMAS: Record<string, NamingSchema> = {\n  kebab: {\n    name: 'kebab-case',\n    patterns: {\n      lowercase: true,\n      separator: '-',\n      maxLength: 100,\n      allowedChars: /^[a-z0-9-]+$/,\n      reservedNames: ['index', 'readme', 'changelog'],\n    },\n  },\n  snake: {\n    name: 'snake_case',\n    patterns: {\n      lowercase: true,\n      separator: '_',\n      maxLength: 100,\n      allowedChars: /^[a-z0-9_]+$/,\n      reservedNames: ['index', 'readme', 'changelog'],\n    },\n  },\n  obsidian: {\n    name: 'Obsidian-friendly',\n    patterns: {\n      lowercase: false,\n      separator: '-',\n      maxLength: 200,\n      allowedChars: /^[a-zA-Z0-9-_ ]+$/,\n      reservedNames: [],\n      allowMixedSeparators: true,\n    },\n  },\n};\n\n// ============================================================================\n// Name Validator Class\n// ============================================================================\n\nexport class NameValidator {\n  private schema: NamingSchema;\n\n  constructor(schemaName = 'kebab') {\n    this.schema = SCHEMAS[schemaName] || SCHEMAS.kebab;\n  }\n\n  /**\n   * Validate all files in a vault\n   */\n  async validateVault(vaultPath: string, options: ValidateNamesOptions = {}): Promise<ValidationResult> {\n    const resolvedPath = path.resolve(vaultPath);\n\n    // Find all markdown files\n    const files = await glob('**/*.md', {\n      cwd: resolvedPath,\n      ignore: ['node_modules/**', '.git/**', 'dist/**'],\n      absolute: false,\n    });\n\n    if (files.length === 0) {\n      throw new Error(`No markdown files found in: ${resolvedPath}`);\n    }\n\n    const valid: string[] = [];\n    const invalid: InvalidFile[] = [];\n    const commonIssues = new Map<string, number>();\n\n    for (const file of files) {\n      const basename = path.basename(file, '.md');\n      const issues = this.validateFilename(basename);\n\n      if (issues.length === 0) {\n        valid.push(file);\n      } else {\n        const suggested = this.suggestRename(basename);\n\n        invalid.push({\n          file,\n          issues,\n          suggested: file.replace(basename + '.md', suggested + '.md'),\n        });\n\n        // Count issues\n        for (const issue of issues) {\n          commonIssues.set(issue, (commonIssues.get(issue) || 0) + 1);\n        }\n      }\n    }\n\n    return {\n      valid,\n      invalid,\n      statistics: {\n        totalFiles: files.length,\n        validCount: valid.length,\n        invalidCount: invalid.length,\n        commonIssues,\n      },\n    };\n  }\n\n  /**\n   * Validate a single filename\n   */\n  validateFilename(filename: string): string[] {\n    const issues: string[] = [];\n    const { patterns } = this.schema;\n\n    // Check for uppercase (if lowercase required)\n    if (patterns.lowercase && filename !== filename.toLowerCase()) {\n      issues.push('Contains uppercase characters');\n    }\n\n    // Check for spaces (unless pattern allows spaces)\n    const allowsSpaces = patterns.allowedChars.test('a b');\n    if (!allowsSpaces && filename.includes(' ')) {\n      issues.push('Contains spaces');\n    }\n\n    // Check for special characters\n    const testName = patterns.lowercase\n      ? filename.toLowerCase()\n      : filename;\n    if (!patterns.allowedChars.test(testName)) {\n      issues.push(`Contains invalid characters (allowed: ${patterns.allowedChars})`);\n    }\n\n    // Check length\n    if (filename.length > patterns.maxLength) {\n      issues.push(`Exceeds maximum length (${patterns.maxLength})`);\n    }\n\n    // Check for consecutive separators\n    const doubleSep = patterns.separator + patterns.separator;\n    if (filename.includes(doubleSep)) {\n      issues.push(`Contains consecutive separators (${doubleSep})`);\n    }\n\n    // Check for leading/trailing separators\n    if (filename.startsWith(patterns.separator) || filename.endsWith(patterns.separator)) {\n      issues.push('Starts or ends with separator');\n    }\n\n    // Check for underscores when using kebab-case (skip if mixed separators allowed)\n    if (!patterns.allowMixedSeparators && patterns.separator === '-' && filename.includes('_')) {\n      issues.push('Contains underscores (use hyphens)');\n    }\n\n    // Check for mixed separators (skip if allowed)\n    if (!patterns.allowMixedSeparators) {\n      if (patterns.separator === '-' && filename.includes('_')) {\n        issues.push('Mixed separators (hyphens and underscores)');\n      }\n      if (patterns.separator === '_' && filename.includes('-')) {\n        issues.push('Mixed separators (underscores and hyphens)');\n      }\n    }\n\n    return issues;\n  }\n\n  /**\n   * Suggest a valid filename\n   */\n  suggestRename(filename: string): string {\n    const { patterns } = this.schema;\n\n    let suggested = filename;\n\n    // Convert to lowercase if required\n    if (patterns.lowercase) {\n      suggested = suggested.toLowerCase();\n    }\n\n    // Replace spaces with separator\n    suggested = suggested.replace(/\\s+/g, patterns.separator);\n\n    // Replace underscores with separator (for kebab-case)\n    if (patterns.separator === '-') {\n      suggested = suggested.replace(/_+/g, '-');\n    }\n\n    // Replace hyphens with separator (for snake_case)\n    if (patterns.separator === '_') {\n      suggested = suggested.replace(/-+/g, '_');\n    }\n\n    // Remove invalid characters\n    suggested = suggested.replace(/[^a-z0-9-_]/g, '');\n\n    // Remove consecutive separators\n    const sepRegex = new RegExp(`${patterns.separator}+`, 'g');\n    suggested = suggested.replace(sepRegex, patterns.separator);\n\n    // Remove leading/trailing separators\n    suggested = suggested.replace(new RegExp(`^${patterns.separator}+|${patterns.separator}+$`, 'g'), '');\n\n    // Truncate if too long\n    if (suggested.length > patterns.maxLength) {\n      suggested = suggested.substring(0, patterns.maxLength);\n      // Clean up any trailing separator after truncation\n      suggested = suggested.replace(new RegExp(`${patterns.separator}+$`, 'g'), '');\n    }\n\n    return suggested || 'untitled';\n  }\n\n  /**\n   * Rename files (with safety checks)\n   */\n  async renameFiles(\n    vaultPath: string,\n    invalidFiles: InvalidFile[],\n    dryRun = false\n  ): Promise<Array<{ from: string; to: string; success: boolean; error?: string }>> {\n    const resolvedPath = path.resolve(vaultPath);\n    const results: Array<{ from: string; to: string; success: boolean; error?: string }> = [];\n\n    for (const { file, suggested } of invalidFiles) {\n      const fromPath = path.join(resolvedPath, file);\n      const toPath = path.join(resolvedPath, suggested);\n\n      // Check if target already exists\n      try {\n        await access(toPath);\n        results.push({\n          from: file,\n          to: suggested,\n          success: false,\n          error: 'Target file already exists',\n        });\n        continue;\n      } catch {\n        // Target doesn't exist, we can proceed\n      }\n\n      if (dryRun) {\n        results.push({\n          from: file,\n          to: suggested,\n          success: true,\n        });\n      } else {\n        try {\n          // Ensure target directory exists\n          await mkdir(path.dirname(toPath), { recursive: true });\n          await rename(fromPath, toPath);\n          results.push({\n            from: file,\n            to: suggested,\n            success: true,\n          });\n        } catch (error) {\n          results.push({\n            from: file,\n            to: suggested,\n            success: false,\n            error: error instanceof Error ? error.message : 'Unknown error',\n          });\n        }\n      }\n    }\n\n    return results;\n  }\n\n  /**\n   * Get current schema\n   */\n  getSchema(): NamingSchema {\n    return this.schema;\n  }\n\n  /**\n   * Generate report\n   */\n  generateReport(result: ValidationResult): string {\n    const lines: string[] = [];\n\n    lines.push('# File Naming Validation Report\\n');\n    lines.push(`Generated: ${new Date().toISOString()}\\n`);\n    lines.push(`Schema: ${this.schema.name}\\n`);\n    lines.push('');\n\n    lines.push('## Summary\\n');\n    lines.push(`| Metric | Value |`);\n    lines.push(`|--------|-------|`);\n    lines.push(`| Total Files | ${result.statistics.totalFiles} |`);\n    lines.push(`| Valid | ${result.statistics.validCount} |`);\n    lines.push(`| Invalid | ${result.statistics.invalidCount} |`);\n    lines.push(`| Compliance | ${((result.statistics.validCount / result.statistics.totalFiles) * 100).toFixed(1)}% |`);\n    lines.push('');\n\n    if (result.statistics.commonIssues.size > 0) {\n      lines.push('## Common Issues\\n');\n      const sortedIssues = [...result.statistics.commonIssues.entries()]\n        .sort((a, b) => b[1] - a[1]);\n      for (const [issue, count] of sortedIssues) {\n        lines.push(`- ${issue}: ${count} files`);\n      }\n      lines.push('');\n    }\n\n    if (result.invalid.length > 0) {\n      lines.push('## Files to Rename\\n');\n      lines.push('| Current | Suggested | Issues |');\n      lines.push('|---------|-----------|--------|');\n      for (const { file, suggested, issues } of result.invalid.slice(0, 50)) {\n        lines.push(`| \\`${file}\\` | \\`${suggested}\\` | ${issues.join(', ')} |`);\n      }\n      if (result.invalid.length > 50) {\n        lines.push(`\\n*... and ${result.invalid.length - 50} more*`);\n      }\n    }\n\n    return lines.join('\\n');\n  }\n}\n\n// ============================================================================\n// CLI Command\n// ============================================================================\n\nexport function createValidateNamesCommand(): Command {\n  const command = new Command('validate-names')\n    .description('Validate file naming schema')\n    .argument('<vault-path>', 'Path to Obsidian vault or docs directory')\n    .option('--schema <name>', 'Naming schema (kebab, snake, obsidian)', 'kebab')\n    .option('--fix', 'Auto-rename invalid files')\n    .option('--dry-run', 'Show what would be renamed without making changes')\n    .option('-o, --output <file>', 'Output file for report')\n    .option('--json', 'Output as JSON')\n    .option('-v, --verbose', 'Show detailed output')\n    .action(async (vaultPath: string, options: ValidateNamesOptions) => {\n      const validator = new NameValidator(options.schema || 'kebab');\n\n      console.log(chalk.cyan(`\\nValidating file names (${validator.getSchema().name})...\\n`));\n\n      try {\n        const result = await validator.validateVault(vaultPath, options);\n\n        if (options.json) {\n          const jsonResult = {\n            ...result,\n            statistics: {\n              ...result.statistics,\n              commonIssues: Object.fromEntries(result.statistics.commonIssues),\n            },\n          };\n\n          if (options.output) {\n            await writeFile(options.output, JSON.stringify(jsonResult, null, 2));\n            console.log(chalk.green(`Results written to: ${options.output}`));\n          } else {\n            console.log(JSON.stringify(jsonResult, null, 2));\n          }\n        } else {\n          // Display summary\n          const compliance = (result.statistics.validCount / result.statistics.totalFiles) * 100;\n          const complianceColor = compliance === 100 ? chalk.green : compliance >= 80 ? chalk.yellow : chalk.red;\n\n          console.log(chalk.bold('Summary:'));\n          console.log(chalk.white(`  Total Files:  ${result.statistics.totalFiles}`));\n          console.log(chalk.green(`  Valid:        ${result.statistics.validCount}`));\n          console.log(chalk.red(`  Invalid:      ${result.statistics.invalidCount}`));\n          console.log(complianceColor(`  Compliance:   ${compliance.toFixed(1)}%`));\n          console.log('');\n\n          if (result.statistics.commonIssues.size > 0) {\n            console.log(chalk.bold('Common Issues:'));\n            const sortedIssues = [...result.statistics.commonIssues.entries()]\n              .sort((a, b) => b[1] - a[1]);\n            for (const [issue, count] of sortedIssues) {\n              console.log(chalk.yellow(`  ${count}x ${issue}`));\n            }\n            console.log('');\n          }\n\n          if (result.invalid.length > 0 && (options.verbose || options.fix || options.dryRun)) {\n            console.log(chalk.bold('Files to Rename:'));\n            for (const { file, suggested, issues } of result.invalid.slice(0, options.verbose ? 50 : 10)) {\n              console.log(chalk.red(`  ${file}`));\n              console.log(chalk.green(`    -> ${suggested}`));\n              if (options.verbose) {\n                console.log(chalk.gray(`       Issues: ${issues.join(', ')}`));\n              }\n            }\n            if (result.invalid.length > (options.verbose ? 50 : 10)) {\n              console.log(chalk.gray(`  ... and ${result.invalid.length - (options.verbose ? 50 : 10)} more`));\n            }\n            console.log('');\n          }\n\n          // Handle fix/dry-run\n          if (options.fix || options.dryRun) {\n            const action = options.dryRun ? 'Preview' : 'Rename';\n            console.log(chalk.bold(`${action}ing files...`));\n\n            const renameResults = await validator.renameFiles(\n              vaultPath,\n              result.invalid,\n              options.dryRun || false\n            );\n\n            const success = renameResults.filter(r => r.success);\n            const failed = renameResults.filter(r => !r.success);\n\n            if (options.dryRun) {\n              console.log(chalk.cyan(`  Would rename ${success.length} files`));\n            } else {\n              console.log(chalk.green(`  Renamed ${success.length} files`));\n            }\n\n            if (failed.length > 0) {\n              console.log(chalk.red(`  Failed: ${failed.length} files`));\n              if (options.verbose) {\n                for (const { from, to, error } of failed) {\n                  console.log(chalk.red(`    ${from} -> ${to}: ${error}`));\n                }\n              }\n            }\n            console.log('');\n          }\n\n          // Write report if output specified\n          if (options.output && !options.json) {\n            const report = validator.generateReport(result);\n            await writeFile(options.output, report);\n            console.log(chalk.green(`Report written to: ${options.output}`));\n          }\n\n          // Show next steps\n          if (result.invalid.length > 0 && !options.fix) {\n            console.log(chalk.bold('Next Steps:'));\n            console.log(chalk.gray('  1. Review invalid file names'));\n            console.log(chalk.gray('  2. Run with --dry-run to preview changes'));\n            console.log(chalk.gray('  3. Run with --fix to auto-rename files'));\n            console.log(chalk.gray('  4. Update links after renaming with kg analyze-links'));\n            console.log('');\n          }\n        }\n      } catch (error) {\n        console.error(chalk.red('Error:'), error instanceof Error ? error.message : 'Unknown error');\n        process.exit(1);\n      }\n    });\n\n  return command;\n}\n\nexport default createValidateNamesCommand;\n"],"names":[],"mappings":"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"}