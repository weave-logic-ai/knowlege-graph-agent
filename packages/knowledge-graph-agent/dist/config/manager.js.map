{"version":3,"file":"manager.js","sources":["../../src/config/manager.ts"],"sourcesContent":["/**\n * Configuration Manager\n *\n * Manages Knowledge Graph configuration with migration support,\n * persistence, and validation.\n *\n * @module config/manager\n */\n\nimport { existsSync, readFileSync, writeFileSync, mkdirSync } from 'fs';\nimport { join, dirname } from 'path';\nimport { createLogger } from '../utils/index.js';\nimport type {\n  KGConfiguration,\n  ConfigMigration,\n  DatabaseConfig,\n  CacheConfig,\n  AgentConfig,\n  ServicesConfig,\n  LoggingConfig,\n} from './types.js';\n\nconst logger = createLogger('config-manager');\n\n/**\n * Default configuration values\n */\nconst DEFAULT_CONFIG: KGConfiguration = {\n  version: '1.0.0',\n  projectRoot: process.cwd(),\n  docsPath: 'docs',\n  database: {\n    path: '.kg/knowledge.db',\n    autoBackup: true,\n    backupInterval: 86400000, // 24 hours\n    maxBackups: 5,\n  },\n  cache: {\n    enabled: true,\n    maxSize: 1000,\n    ttl: 3600000, // 1 hour\n    evictionPolicy: 'lru',\n  },\n  agents: {\n    maxConcurrent: 5,\n    defaultTimeout: 30000, // 30 seconds\n    retryAttempts: 3,\n    claudeFlowEnabled: true,\n  },\n  services: {\n    watcherEnabled: true,\n    schedulerEnabled: true,\n    syncEnabled: true,\n    healthCheckInterval: 60000, // 1 minute\n  },\n  logging: {\n    level: 'info',\n    format: 'text',\n  },\n};\n\n/**\n * Configuration Manager class\n *\n * Handles loading, saving, and migrating configuration files.\n */\nexport class ConfigManager {\n  private config: KGConfiguration;\n  private configPath: string;\n  private migrations: ConfigMigration[] = [];\n\n  /**\n   * Create a new ConfigManager instance\n   *\n   * @param projectRoot - Root directory of the project\n   * @param configPath - Optional custom config file path\n   */\n  constructor(projectRoot: string, configPath?: string) {\n    this.configPath = configPath || join(projectRoot, '.kg/config.json');\n    this.config = this.load();\n    // Update projectRoot to match the actual project root\n    this.config.projectRoot = projectRoot;\n  }\n\n  /**\n   * Load configuration from file\n   *\n   * @returns Loaded configuration merged with defaults\n   */\n  private load(): KGConfiguration {\n    if (!existsSync(this.configPath)) {\n      logger.debug('No config file found, using defaults', { path: this.configPath });\n      return { ...DEFAULT_CONFIG };\n    }\n\n    try {\n      const data = readFileSync(this.configPath, 'utf-8');\n      const loaded = JSON.parse(data) as Partial<KGConfiguration>;\n      logger.debug('Loaded configuration', { path: this.configPath, version: loaded.version });\n      return this.mergeWithDefaults(loaded);\n    } catch (error) {\n      logger.warn('Failed to load config, using defaults', {\n        error: error instanceof Error ? error.message : String(error),\n      });\n      return { ...DEFAULT_CONFIG };\n    }\n  }\n\n  /**\n   * Merge loaded configuration with defaults\n   *\n   * @param loaded - Partially loaded configuration\n   * @returns Complete configuration with defaults filled in\n   */\n  private mergeWithDefaults(loaded: Partial<KGConfiguration>): KGConfiguration {\n    return {\n      ...DEFAULT_CONFIG,\n      ...loaded,\n      database: { ...DEFAULT_CONFIG.database, ...loaded.database } as DatabaseConfig,\n      cache: { ...DEFAULT_CONFIG.cache, ...loaded.cache } as CacheConfig,\n      agents: { ...DEFAULT_CONFIG.agents, ...loaded.agents } as AgentConfig,\n      services: { ...DEFAULT_CONFIG.services, ...loaded.services } as ServicesConfig,\n      logging: { ...DEFAULT_CONFIG.logging, ...loaded.logging } as LoggingConfig,\n    };\n  }\n\n  /**\n   * Save configuration to file\n   */\n  save(): void {\n    const dir = dirname(this.configPath);\n    if (!existsSync(dir)) {\n      mkdirSync(dir, { recursive: true });\n    }\n\n    try {\n      writeFileSync(this.configPath, JSON.stringify(this.config, null, 2));\n      logger.info('Configuration saved', { path: this.configPath });\n    } catch (error) {\n      logger.error('Failed to save configuration', error instanceof Error ? error : undefined, {\n        path: this.configPath,\n      });\n      throw error;\n    }\n  }\n\n  /**\n   * Get a configuration value by key\n   *\n   * @param key - Configuration key\n   * @returns Configuration value for the key\n   */\n  get<K extends keyof KGConfiguration>(key: K): KGConfiguration[K] {\n    return this.config[key];\n  }\n\n  /**\n   * Set a configuration value\n   *\n   * @param key - Configuration key\n   * @param value - Value to set\n   */\n  set<K extends keyof KGConfiguration>(key: K, value: KGConfiguration[K]): void {\n    this.config[key] = value;\n    this.save();\n  }\n\n  /**\n   * Update multiple configuration values\n   *\n   * @param updates - Partial configuration to merge\n   */\n  update(updates: Partial<KGConfiguration>): void {\n    this.config = this.mergeWithDefaults({ ...this.config, ...updates });\n    this.save();\n  }\n\n  /**\n   * Get the complete configuration\n   *\n   * @returns Complete configuration object (copy)\n   */\n  getAll(): KGConfiguration {\n    return { ...this.config };\n  }\n\n  /**\n   * Register a configuration migration\n   *\n   * @param migration - Migration definition\n   */\n  registerMigration(migration: ConfigMigration): void {\n    this.migrations.push(migration);\n    // Sort migrations by version\n    this.migrations.sort((a, b) => a.version.localeCompare(b.version, undefined, { numeric: true }));\n    logger.debug('Registered migration', { version: migration.version });\n  }\n\n  /**\n   * Run migrations to target version\n   *\n   * @param targetVersion - Target version to migrate to (defaults to latest)\n   */\n  migrate(targetVersion?: string): void {\n    const currentVersion = this.config.version;\n    const target =\n      targetVersion || this.migrations[this.migrations.length - 1]?.version || currentVersion;\n\n    if (currentVersion === target) {\n      logger.info('Config already at target version', { version: target });\n      return;\n    }\n\n    const isUpgrade = this.compareVersions(currentVersion, target) < 0;\n\n    // Filter applicable migrations\n    const applicableMigrations = this.migrations.filter((m) => {\n      if (isUpgrade) {\n        return (\n          this.compareVersions(m.version, currentVersion) > 0 &&\n          this.compareVersions(m.version, target) <= 0\n        );\n      } else {\n        return (\n          this.compareVersions(m.version, currentVersion) <= 0 &&\n          this.compareVersions(m.version, target) > 0\n        );\n      }\n    });\n\n    // Reverse order for downgrades\n    if (!isUpgrade) {\n      applicableMigrations.reverse();\n    }\n\n    // Apply migrations\n    for (const migration of applicableMigrations) {\n      logger.info(`Applying migration ${migration.version}`, {\n        direction: isUpgrade ? 'up' : 'down',\n      });\n\n      try {\n        const result = isUpgrade ? migration.up(this.config) : migration.down(this.config);\n        this.config = this.mergeWithDefaults(result);\n        this.config.version = isUpgrade\n          ? migration.version\n          : this.getPreviousVersion(migration.version);\n      } catch (error) {\n        logger.error(\n          `Migration ${migration.version} failed`,\n          error instanceof Error ? error : undefined\n        );\n        throw error;\n      }\n    }\n\n    // Set final version\n    this.config.version = target;\n    this.save();\n    logger.info('Migration complete', { from: currentVersion, to: target });\n  }\n\n  /**\n   * Compare two version strings\n   *\n   * @param a - First version\n   * @param b - Second version\n   * @returns Negative if a < b, 0 if equal, positive if a > b\n   */\n  private compareVersions(a: string, b: string): number {\n    const partsA = a.split('.').map(Number);\n    const partsB = b.split('.').map(Number);\n\n    for (let i = 0; i < Math.max(partsA.length, partsB.length); i++) {\n      const partA = partsA[i] || 0;\n      const partB = partsB[i] || 0;\n      if (partA !== partB) {\n        return partA - partB;\n      }\n    }\n    return 0;\n  }\n\n  /**\n   * Get the version before a given version\n   *\n   * @param version - Current version\n   * @returns Previous version string\n   */\n  private getPreviousVersion(version: string): string {\n    const index = this.migrations.findIndex((m) => m.version === version);\n    if (index > 0) {\n      return this.migrations[index - 1].version;\n    }\n    // Return a default previous version\n    const parts = version.split('.').map(Number);\n    if (parts[2] > 0) {\n      parts[2]--;\n    } else if (parts[1] > 0) {\n      parts[1]--;\n      parts[2] = 0;\n    } else if (parts[0] > 0) {\n      parts[0]--;\n      parts[1] = 0;\n      parts[2] = 0;\n    }\n    return parts.join('.');\n  }\n\n  /**\n   * Reset configuration to defaults\n   */\n  reset(): void {\n    this.config = { ...DEFAULT_CONFIG, projectRoot: this.config.projectRoot };\n    this.save();\n    logger.info('Configuration reset to defaults');\n  }\n\n  /**\n   * Get the configuration file path\n   *\n   * @returns Path to the configuration file\n   */\n  getConfigPath(): string {\n    return this.configPath;\n  }\n\n  /**\n   * Check if configuration file exists\n   *\n   * @returns True if config file exists\n   */\n  exists(): boolean {\n    return existsSync(this.configPath);\n  }\n\n  /**\n   * Validate the current configuration\n   *\n   * @returns Validation result with any errors\n   */\n  validate(): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    // Validate version\n    if (!this.config.version.match(/^\\d+\\.\\d+\\.\\d+$/)) {\n      errors.push('Invalid version format, expected semver (e.g., 1.0.0)');\n    }\n\n    // Validate database config\n    if (!this.config.database.path) {\n      errors.push('Database path is required');\n    }\n    if (this.config.database.backupInterval < 0) {\n      errors.push('Database backup interval must be non-negative');\n    }\n    if (this.config.database.maxBackups < 0) {\n      errors.push('Database max backups must be non-negative');\n    }\n\n    // Validate cache config\n    if (this.config.cache.maxSize < 0) {\n      errors.push('Cache max size must be non-negative');\n    }\n    if (this.config.cache.ttl < 0) {\n      errors.push('Cache TTL must be non-negative');\n    }\n    if (!['lru', 'lfu', 'fifo'].includes(this.config.cache.evictionPolicy)) {\n      errors.push('Invalid cache eviction policy');\n    }\n\n    // Validate agents config\n    if (this.config.agents.maxConcurrent < 1) {\n      errors.push('Agents max concurrent must be at least 1');\n    }\n    if (this.config.agents.defaultTimeout < 0) {\n      errors.push('Agents default timeout must be non-negative');\n    }\n    if (this.config.agents.retryAttempts < 0) {\n      errors.push('Agents retry attempts must be non-negative');\n    }\n\n    // Validate services config\n    if (this.config.services.healthCheckInterval < 0) {\n      errors.push('Health check interval must be non-negative');\n    }\n\n    // Validate logging config\n    if (!['debug', 'info', 'warn', 'error'].includes(this.config.logging.level)) {\n      errors.push('Invalid logging level');\n    }\n    if (!['json', 'text'].includes(this.config.logging.format)) {\n      errors.push('Invalid logging format');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n}\n\n/**\n * Create a new ConfigManager instance\n *\n * @param projectRoot - Root directory of the project\n * @param configPath - Optional custom config file path\n * @returns ConfigManager instance\n */\nexport function createConfigManager(projectRoot: string, configPath?: string): ConfigManager {\n  return new ConfigManager(projectRoot, configPath);\n}\n\n/**\n * Get a copy of the default configuration\n *\n * @returns Default configuration object\n */\nexport function getDefaultConfig(): KGConfiguration {\n  return { ...DEFAULT_CONFIG };\n}\n"],"names":[],"mappings":"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"}