{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["/**\n * Knowledge Graph Agent\n *\n * NPM library for creating and managing knowledge graphs for Claude Code.\n *\n * @packageDocumentation\n */\n\n// Internal imports for quickInit\nimport { createDatabase as _createDatabase } from './core/database.js';\nimport { initDocs as _initDocs, docsExist as _docsExist } from './generators/docs-init.js';\nimport { generateAndSave as _generateAndSave } from './generators/graph-generator.js';\nimport { updateClaudeMd as _updateClaudeMd } from './generators/claude-md.js';\n\n// ============================================================================\n// Core\n// ============================================================================\n\nexport {\n  KnowledgeGraphManager,\n  createKnowledgeGraph,\n} from './core/graph.js';\n\nexport {\n  KnowledgeGraphDatabase,\n  createDatabase,\n} from './core/database.js';\n\n// Cache exports\nexport {\n  ShadowCache,\n  createShadowCache,\n  loadShadowCache,\n} from './core/cache.js';\n\nexport type {\n  FileMetadata,\n  FileType,\n  ChangeType,\n  FileChange,\n  CacheStats,\n  ShadowCacheOptions,\n} from './core/cache.js';\n\nexport type {\n  // Node types\n  NodeType,\n  NodeStatus,\n  NodeLink,\n  NodeFrontmatter,\n  KnowledgeNode,\n\n  // Graph types\n  GraphEdge,\n  GraphMetadata,\n  GraphStats,\n  KnowledgeGraph,\n\n  // Configuration\n  KGConfig,\n  ConfigSchema,\n\n  // Generator types\n  GeneratorOptions,\n  GeneratedDocument,\n  DocsInitOptions,\n  DocsInitResult,\n\n  // Integration types\n  MemoryEntry,\n  SyncResult,\n\n  // CLAUDE.md types\n  ClaudeMdSection,\n  ClaudeMdTemplate,\n  ClaudeMdGeneratorOptions,\n} from './core/types.js';\n\n// ============================================================================\n// Generators\n// ============================================================================\n\nexport {\n  generateGraph,\n  generateAndSave,\n  updateGraph,\n} from './generators/graph-generator.js';\n\nexport {\n  initDocs,\n  docsExist,\n  getDocsPath,\n} from './generators/docs-init.js';\n\nexport {\n  generateClaudeMd,\n  updateClaudeMd,\n  addSection,\n  getSectionTemplate,\n  listSectionTemplates,\n} from './generators/claude-md.js';\n\n// Conversion exports\nexport {\n  convertDocs,\n  addFrontmatter,\n  validateFrontmatter,\n} from './generators/docs-convert.js';\n\nexport type {\n  ConvertOptions,\n  ConvertResult,\n  FrontmatterOptions,\n  FrontmatterResult,\n} from './generators/docs-convert.js';\n\n// Analyzer exports\nexport {\n  analyzeDocs,\n} from './generators/docs-analyzer.js';\n\nexport type {\n  AnalyzerOptions,\n  AnalyzedDoc,\n  AnalyzerResult,\n} from './generators/docs-analyzer.js';\n\n// ============================================================================\n// Integrations\n// ============================================================================\n\nexport {\n  ClaudeFlowIntegration,\n  createClaudeFlowIntegration,\n  generateMcpConfig,\n} from './integrations/claude-flow.js';\n\n// ============================================================================\n// CLI\n// ============================================================================\n\nexport { createCLI } from './cli/index.js';\n\n// ============================================================================\n// Agents\n// ============================================================================\n\nexport {\n  // Agent system core\n  AgentType,\n  AgentStatus,\n  TaskPriority,\n  MessageType,\n  createMessageId,\n  createTaskId,\n  createAgentId,\n\n  // Registry\n  AgentRegistry,\n  getRegistry,\n  createRegistry,\n  setDefaultRegistry,\n  registerDefaultAgents,\n\n  // Base Agent\n  BaseAgent,\n  createTask,\n  isAgentResult,\n  isAgentError,\n\n  // Specialized Agents\n  ResearcherAgent,\n  CoderAgent,\n  TesterAgent,\n  AnalystAgent,\n  ArchitectAgent,\n\n  // Rules Engine\n  RulesEngine,\n  createRulesEngine,\n  createRule,\n  createConditionalRule,\n  createFileChangeLogRule,\n  createGraphUpdateNotificationRule,\n  createAgentCompletionRule,\n} from './agents/index.js';\n\nexport type {\n  // Agent types\n  AgentConfig,\n  ResearcherAgentConfig,\n  CoderAgentConfig,\n  TesterAgentConfig,\n  AnalystAgentConfig,\n  ArchitectAgentConfig,\n  SpecializedAgentConfig,\n  TaskInput,\n  AgentTask,\n  AgentResult as AgentSystemResult,\n  AgentError,\n  ExecutionMetrics,\n  ResultArtifact,\n  AgentMessage,\n  TaskRequestMessage,\n  TaskResponseMessage,\n  StatusMessage,\n  ErrorMessage,\n  CoordinationMessage,\n  AgentMessageUnion,\n  AgentState,\n  AgentFactory,\n  AgentInstance,\n  AgentCapability,\n  AgentHealthCheck,\n  RegistryOptions,\n  SpawnOptions,\n\n  // Rules Engine types\n  RuleTrigger,\n  RulePriority,\n  RuleExecutionStatus,\n  RuleContext,\n  RuleCondition,\n  RuleAction,\n  AgentRule,\n  RuleExecutionLog,\n  RuleStatistics,\n  EngineStatistics,\n  RulesEngineConfig,\n} from './agents/index.js';\n\n// ============================================================================\n// Cultivation\n// ============================================================================\n\nexport {\n  SeedGenerator,\n  analyzeSeed,\n  initPrimitives,\n  DeepAnalyzer,\n  createDeepAnalyzer,\n  analyzeDeep,\n} from './cultivation/index.js';\n\nexport type {\n  VaultContext,\n  Ecosystem,\n  DependencyType,\n  ServiceType,\n  DependencyInfo,\n  ServiceInfo,\n  SeedAnalysis,\n  DocumentMetadata as CultivationDocumentMetadata,\n  GeneratedDocument as CultivationGeneratedDocument,\n  CultivationReport,\n  CultivationOptions,\n  GapAnalysis as CultivationGapAnalysis,\n  InitPrimitivesResult,\n  DeepAnalyzerOptions,\n  AgentResult,\n  DeepAnalysisResult,\n} from './cultivation/index.js';\n\n// ============================================================================\n// SOPs\n// ============================================================================\n\nexport {\n  // Enums\n  SOPCategory,\n  ComplianceStatus,\n  SOPPriority,\n  IRBStatus,\n  GraphLayer,\n  // Registry\n  getSOPById,\n  getSOPsByCategory,\n  getSOPsRequiringIRB,\n  searchSOPs,\n  getAllSOPs,\n  getSopCount,\n  getCategories,\n  // Compliance\n  checkCompliance,\n  checkSOPCompliance,\n  meetsMinimumCompliance,\n  // Gap Analysis\n  analyzeGaps,\n  getGapsForSOP,\n  getQuickWins,\n  calculateProgress,\n  // Overlay Management\n  createMultiLayerGraph,\n  addProjectLayer,\n  addComplianceOverlay,\n  filterByLayer,\n  filterByComplianceStatus,\n  getComplianceSummary,\n  getGapNodes,\n  toggleLayerVisibility,\n  exportToVisualizationFormat,\n  createSOPFocusedSubgraph,\n} from './sops/index.js';\n\nexport type {\n  // SOP types\n  SOPRequirement,\n  SOPCheckpoint,\n  SOPDefinition,\n  SOPAssessment,\n  ComplianceGap,\n  LayerDefinition,\n  LayerNode,\n  LayerEdge,\n  MultiLayerGraph,\n  ComplianceReport,\n  SOPFrontmatter,\n  SOPConfig,\n  // Compliance types\n  ComplianceCheckOptions,\n  ComplianceCheckResult,\n  EvidenceItem,\n  // Gap types\n  GapAnalysisOptions,\n  GapAnalysisResult,\n  GapSummary,\n  RemediationRoadmap,\n  RemediationPhase,\n  GapDependency,\n  // Overlay types\n  OverlayManagerOptions,\n  NodeStyleConfig,\n} from './sops/index.js';\n\n// ============================================================================\n// Workflows\n// ============================================================================\n\nexport {\n  WorkflowStatus,\n  WorkflowRegistry,\n  createWorkflowRegistry,\n} from './workflows/index.js';\n\nexport type {\n  StepContext,\n  StepHandler,\n  RollbackHandler,\n  WorkflowStep,\n  WorkflowDefinition,\n  StepExecution,\n  WorkflowExecution,\n  WorkflowResult,\n  WorkflowExecutionStats,\n  WorkflowRegistryOptions,\n  WorkflowListOptions,\n  ExecutionHistoryOptions,\n  WorkflowEventType,\n  WorkflowEvent,\n  WorkflowEventListener,\n} from './workflows/index.js';\n\n// ============================================================================\n// Memory\n// ============================================================================\n\nexport {\n  VaultMemorySync,\n  createVaultMemorySync,\n} from './memory/index.js';\n\nexport type {\n  SyncDirection,\n  ConflictStrategy,\n  SyncStatus,\n  MemoryNode,\n  SyncConflict,\n  VaultSyncOptions,\n  SyncOperationResult,\n  FullSyncResult,\n} from './memory/index.js';\n\n// ============================================================================\n// Utils\n// ============================================================================\n\nexport {\n  // Error Taxonomy\n  ErrorCategory,\n  ErrorSeverity,\n  classifyError,\n  isRetryableError,\n  isTransientError,\n  isRateLimitError,\n  isPermanentError,\n  KnowledgeGraphError,\n  createValidationError,\n  createConfigurationError,\n  createResourceError,\n  // Error Recovery\n  withRetry,\n  retry,\n  withFallback,\n  withCircuitBreaker,\n  retryable,\n  calculateBackoff,\n  sleep,\n  CircuitBreaker,\n  CircuitState,\n  RetriesExhaustedError,\n  CircuitOpenError,\n  // Logger\n  Logger,\n  LogLevel,\n  getLogger,\n  createLogger,\n  setDefaultLogger,\n  parseLogLevel,\n  createProgressLogger,\n} from './utils/index.js';\n\nexport type {\n  ClassifiedError,\n  RetryOptions,\n  RetryResult,\n  FallbackOptions,\n  CircuitBreakerOptions,\n  LoggerOptions,\n  LogEntry,\n  ProgressLogger,\n} from './utils/index.js';\n\n// ============================================================================\n// MCP Server\n// ============================================================================\n\nexport {\n  KnowledgeGraphMCPServer,\n  createMCPServer,\n  runServer,\n  initializeTools,\n  registerTool,\n  getToolHandler,\n  getToolDefinition,\n  getToolDefinitions,\n  getToolCategories,\n  handleToolCall,\n  handleError,\n  createErrorResult,\n  createSuccessResult,\n} from './mcp-server/index.js';\n\nexport type {\n  MCPServerConfig,\n  ServerHealth,\n  ToolCategory,\n  ToolHandler,\n  ToolHandlerEntry,\n  ToolResult,\n  ToolContext,\n  ToolInputSchema,\n  ToolDefinition,\n  GraphQueryParams,\n  GraphNodeResult,\n  AgentInvokeParams,\n  AgentResult as MCPAgentResult,\n  WorkflowParams,\n  WorkflowResult as MCPWorkflowResult,\n  MemoryParams,\n  MemoryResult,\n} from './mcp-server/index.js';\n\n// ============================================================================\n// Server Infrastructure\n// ============================================================================\n\nexport {\n  // Server Manager\n  ServerManager,\n  createServerManager,\n\n  // Shared Services\n  SharedServices,\n  createSharedServices,\n  getSharedServices,\n  createDefaultConfig,\n\n  // Service Container\n  ServiceContainer,\n  createServiceContainer,\n  getServiceContainer,\n  hasServiceContainer,\n  shutdownServiceContainer,\n\n  // TypedEventBus\n  TypedEventBus,\n  createTypedEventBus,\n  createSubscriptionIterator,\n  createNodeTypeFilter,\n  createSourceFilter,\n\n  // Constants\n  DEFAULT_GRAPHQL_PORT,\n  DEFAULT_DASHBOARD_PORT,\n  DEFAULT_DATABASE_PATH,\n  SHUTDOWN_TIMEOUT,\n  HEALTH_CHECK_INTERVAL,\n} from './server/index.js';\n\nexport type {\n  // Configuration types\n  ServerConfig,\n  MCPServerConfig as ServerMCPConfig,\n  GraphQLServerConfig,\n  DashboardServerConfig,\n  DatabaseServerConfig,\n  CacheServerConfig,\n\n  // State types\n  ServerStatus,\n  ServerState,\n  ServerManagerState,\n\n  // Health types\n  ComponentHealth as ServerComponentHealth,\n  HealthStatus as ServerHealthStatus,\n\n  // Event types\n  ServerEventType,\n  ServerEvent,\n  ServerEventListener,\n\n  // Instance types\n  HTTPServerInstance,\n  MCPServerInstance,\n\n  // CLI types\n  ServeCommandOptions,\n  ParsedServeOptions,\n\n  // Interface types\n  ISharedServices,\n  IServerManager,\n\n  // Service Container types\n  ServiceInitState,\n  ServiceDependency,\n  ContainerConfig,\n  ContainerEventType,\n\n  // TypedEventBus types\n  EventType as ServerEventTypeEnum,\n  EventDataMap,\n  EventEntry,\n  EventFilter,\n  EventHandler as ServerEventHandler,\n  Unsubscribe,\n  NodeEventData,\n  RelationEventData,\n  AgentEventData,\n  WorkflowEventData,\n  PluginEventData,\n  HealthEventData,\n  CacheEvictionData,\n  EventTypeMetrics,\n  EventBusMetrics,\n  ITypedEventBus,\n  TypedEventBusOptions,\n} from './server/index.js';\n\n// ============================================================================\n// GraphQL\n// ============================================================================\n\nexport {\n  // Server\n  createGraphQLServer,\n\n  // Context\n  createContextFactory,\n  hasScope,\n  requireAuth,\n  requireScope,\n  isGraphQLContext,\n\n  // Scalars\n  DateTimeScalar,\n  JSONScalar,\n  UUIDScalar,\n  FilePathScalar,\n  customScalars,\n  scalarTypeDefs,\n} from './graphql/index.js';\n\nexport type {\n  // Server types\n  GraphQLServerConfig as GraphQLServerOptions,\n  GraphQLServerInstance,\n  CorsConfig,\n  HealthCheckResponse as GraphQLHealthCheckResponse,\n\n  // Context types\n  GraphQLContext,\n  AuthResult,\n  RequestMeta,\n  RequestUtils,\n  Services as GraphQLServices,\n  ContextFactoryConfig,\n} from './graphql/index.js';\n\n// ============================================================================\n// Services\n// ============================================================================\n\nexport {\n  ServiceManager,\n  createServiceManager,\n  FileWatcherService,\n} from './services/index.js';\n\nexport type {\n  ServiceStatus,\n  ServiceType as ManagerServiceType,\n  ServiceConfig,\n  ServiceState,\n  ServiceMetrics,\n  ServiceHandler,\n} from './services/index.js';\n\n// ============================================================================\n// Config\n// ============================================================================\n\nexport {\n  ConfigManager,\n  createConfigManager,\n  getDefaultConfig,\n} from './config/index.js';\n\nexport type {\n  KGConfiguration,\n  DatabaseConfig,\n  CacheConfig,\n  AgentConfig as ConfigAgentConfig,\n  ServicesConfig,\n  LoggingConfig,\n  ConfigMigration,\n} from './config/index.js';\n\n// ============================================================================\n// Health\n// ============================================================================\n\nexport {\n  HealthMonitor,\n  createHealthMonitor,\n  createDatabaseCheck,\n  createCacheCheck,\n  createMemoryCheck,\n  createDiskCheck,\n} from './health/index.js';\n\nexport type {\n  HealthStatus,\n  ComponentHealth,\n  SystemHealth,\n  MemoryMetrics,\n  PerformanceMetrics,\n  HealthCheck,\n  HealthMonitorConfig,\n} from './health/index.js';\n\n// ============================================================================\n// Chunking\n// ============================================================================\n\nexport {\n  Chunker,\n  createChunker,\n  chunkDocument,\n} from './chunking/index.js';\n\nexport type {\n  ChunkStrategy,\n  ChunkOptions,\n  Chunk,\n  ChunkMetadata,\n  ChunkResult,\n} from './chunking/index.js';\n\n// ============================================================================\n// Recovery\n// ============================================================================\n\nexport {\n  BackupManager,\n  createBackupManager,\n  IntegrityChecker,\n  createIntegrityChecker,\n  checkDatabaseIntegrity,\n} from './recovery/index.js';\n\nexport type {\n  BackupConfig,\n  BackupInfo,\n  RestoreResult,\n  RecoveryOptions,\n  IntegrityCheckResult,\n  TableIntegrity,\n} from './recovery/index.js';\n\n// ============================================================================\n// Advanced Caching\n// ============================================================================\n\nexport {\n  AdvancedCache,\n  createAdvancedCache,\n} from './caching/index.js';\n\nexport type {\n  EvictionPolicy,\n  CacheEntry,\n  CacheConfig as AdvancedCacheConfig,\n  CacheStats as AdvancedCacheStats,\n} from './caching/index.js';\n\n// ============================================================================\n// Reasoning\n// ============================================================================\n\nexport {\n  DecisionTracker,\n  createDecisionTracker,\n  getDecisionTracker,\n} from './reasoning/index.js';\n\nexport type {\n  DecisionType,\n  ConfidenceLevel,\n  Decision,\n  DecisionContext,\n  Alternative,\n  DecisionOutcome,\n  ReasoningChain,\n} from './reasoning/index.js';\n\n// ============================================================================\n// Workflow DevKit\n// ============================================================================\n\nexport {\n  createWorkflowConfig,\n  validateWorkflowConfig,\n  createPostgresConfig,\n  createVercelConfig,\n  createLocalConfig,\n  defaultConfig as defaultWorkflowConfig,\n} from './workflow/index.js';\n\nexport type {\n  // Configuration types\n  WorkflowConfig as WorkflowDevKitConfig,\n  PostgresPoolConfig,\n  PostgresWorldConfig,\n  VercelWorldConfig,\n  LocalWorldConfig,\n  // World state types\n  WorldState,\n  // Event types\n  NodeUpdateEvent,\n  GapDetectedEvent,\n  WorkflowCompleteEvent,\n  WorkflowRunMetadata as DevKitRunMetadata,\n  // Task types\n  TaskSpec,\n  DocumentGap,\n  GapAnalysis as DevKitGapAnalysis,\n  // GOAP types\n  GOAPAction,\n  GOAPGoal,\n  GOAPPlanStep,\n  GOAPPlan,\n  GOAPPlanExtended,\n  PlanExecutionResult,\n  ReadinessEvaluation,\n  // Execution types\n  WorkflowExecutionOptions as DevKitExecutionOptions,\n  WorkflowExecutionResult as DevKitExecutionResult,\n  // Hook types\n  HookHandler,\n  HookRegistration,\n} from './workflow/index.js';\n\n// ============================================================================\n// Plugins\n// ============================================================================\n\n// Plugin System - Core exports (includes types, manager, analyzers)\n// This re-exports everything from plugins/index.js including:\n// - Types: PluginType, PluginHook, PluginStatus, PluginCapability, PluginDependency,\n//          PluginConfigSchema, KGPluginManifest, PluginMetadata, KGPlugin, AnalyzerPlugin,\n//          PluginContext, PluginAPI, PluginCommand, PluginEventEmitter, PluginLoader,\n//          PluginRegistry, PluginManager, PluginManagerConfig, DiscoveredPlugin,\n//          PluginLoadOptions, PluginLoadResult, PluginRegistryEvents, AnalysisInput,\n//          AnalysisResult, AnalysisStreamChunk, PluginFactory, PluginConstructor,\n//          PluginModuleExport, PluginConfigType\n// - Manager: PluginManagerImpl, PluginRegistryImpl, PluginLoaderImpl,\n//            createPluginManager, createPluginRegistry, createPluginLoader,\n//            createDefaultPluginManager\n// - Analyzers: CodeComplexityPlugin, DependencyHealthPlugin, and related exports\nexport * from './plugins/index.js';\n\n// ============================================================================\n// Equilibrium (SPEC-006a)\n// ============================================================================\n\nexport {\n  AgentEquilibriumSelector,\n  createAgentEquilibriumSelector,\n  createEquilibriumTask,\n} from './equilibrium/index.js';\n\nexport type {\n  AgentParticipation,\n  EquilibriumConfig,\n  EquilibriumResult,\n  Task as EquilibriumTask,\n} from './equilibrium/index.js';\n\n// ============================================================================\n// Quick Start\n// ============================================================================\n\n/**\n * Quick start function for programmatic usage\n *\n * @example\n * ```typescript\n * import { quickInit } from '@weave-nn/knowledge-graph-agent';\n *\n * await quickInit({\n *   projectRoot: '/path/to/project',\n *   docsPath: 'docs',\n * });\n * ```\n */\nexport async function quickInit(options: {\n  projectRoot: string;\n  docsPath?: string;\n  generateGraph?: boolean;\n  updateClaudeMd?: boolean;\n}): Promise<{\n  success: boolean;\n  docsCreated: boolean;\n  graphGenerated: boolean;\n  claudeMdUpdated: boolean;\n  errors: string[];\n}> {\n  const {\n    projectRoot,\n    docsPath = 'docs',\n    generateGraph: genGraph = true,\n    updateClaudeMd: updateClaude = true,\n  } = options;\n\n  const result = {\n    success: true,\n    docsCreated: false,\n    graphGenerated: false,\n    claudeMdUpdated: false,\n    errors: [] as string[],\n  };\n\n  try {\n    // Initialize docs if needed\n    const { existsSync, mkdirSync, writeFileSync } = await import('fs');\n    const { join } = await import('path');\n\n    // Create .kg directory\n    const kgDir = join(projectRoot, '.kg');\n    if (!existsSync(kgDir)) {\n      mkdirSync(kgDir, { recursive: true });\n    }\n\n    // Initialize database\n    const dbPath = join(kgDir, 'knowledge.db');\n    const db = _createDatabase(dbPath);\n    db.setMetadata('initialized', new Date().toISOString());\n\n    // Initialize docs\n    if (!_docsExist(projectRoot, docsPath)) {\n      const docsResult = await _initDocs({\n        projectRoot,\n        docsPath,\n        includeExamples: true,\n        detectFramework: true,\n      });\n      result.docsCreated = docsResult.success;\n      if (!docsResult.success) {\n        result.errors.push(...docsResult.errors);\n      }\n    }\n\n    // Generate graph\n    if (genGraph && _docsExist(projectRoot, docsPath)) {\n      const graphResult = await _generateAndSave(\n        {\n          projectRoot,\n          outputPath: join(projectRoot, docsPath),\n        },\n        dbPath\n      );\n      result.graphGenerated = graphResult.success;\n      if (!graphResult.success) {\n        result.errors.push(...graphResult.stats.errors);\n      }\n    }\n\n    // Update CLAUDE.md\n    if (updateClaude) {\n      const claudeResult = await _updateClaudeMd({\n        projectRoot,\n        includeKnowledgeGraph: true,\n        includeClaudeFlow: true,\n      });\n      result.claudeMdUpdated = claudeResult.created || claudeResult.updated;\n    }\n\n    db.close();\n    result.success = result.errors.length === 0;\n\n  } catch (error) {\n    result.success = false;\n    result.errors.push(String(error));\n  }\n\n  return result;\n}\n"],"names":["_createDatabase","_docsExist","_initDocs","_generateAndSave","_updateClaudeMd"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+0BA,eAAsB,UAAU,SAW7B;AACD,QAAM;AAAA,IACJ;AAAA,IACA,WAAW;AAAA,IACX,eAAe,WAAW;AAAA,IAC1B,gBAAgB,eAAe;AAAA,EAAA,IAC7B;AAEJ,QAAM,SAAS;AAAA,IACb,SAAS;AAAA,IACT,aAAa;AAAA,IACb,gBAAgB;AAAA,IAChB,iBAAiB;AAAA,IACjB,QAAQ,CAAA;AAAA,EAAC;AAGX,MAAI;AAEF,UAAM,EAAE,YAAY,WAAW,kBAAkB,MAAM,OAAO,IAAI;AAClE,UAAM,EAAE,KAAA,IAAS,MAAM,OAAO,MAAM;AAGpC,UAAM,QAAQ,KAAK,aAAa,KAAK;AACrC,QAAI,CAAC,WAAW,KAAK,GAAG;AACtB,gBAAU,OAAO,EAAE,WAAW,KAAA,CAAM;AAAA,IACtC;AAGA,UAAM,SAAS,KAAK,OAAO,cAAc;AACzC,UAAM,KAAKA,eAAgB,MAAM;AACjC,OAAG,YAAY,gBAAe,oBAAI,KAAA,GAAO,aAAa;AAGtD,QAAI,CAACC,UAAW,aAAa,QAAQ,GAAG;AACtC,YAAM,aAAa,MAAMC,SAAU;AAAA,QACjC;AAAA,QACA;AAAA,QACA,iBAAiB;AAAA,QACjB,iBAAiB;AAAA,MAAA,CAClB;AACD,aAAO,cAAc,WAAW;AAChC,UAAI,CAAC,WAAW,SAAS;AACvB,eAAO,OAAO,KAAK,GAAG,WAAW,MAAM;AAAA,MACzC;AAAA,IACF;AAGA,QAAI,YAAYD,UAAW,aAAa,QAAQ,GAAG;AACjD,YAAM,cAAc,MAAME;AAAAA,QACxB;AAAA,UACE;AAAA,UACA,YAAY,KAAK,aAAa,QAAQ;AAAA,QAAA;AAAA,QAExC;AAAA,MAAA;AAEF,aAAO,iBAAiB,YAAY;AACpC,UAAI,CAAC,YAAY,SAAS;AACxB,eAAO,OAAO,KAAK,GAAG,YAAY,MAAM,MAAM;AAAA,MAChD;AAAA,IACF;AAGA,QAAI,cAAc;AAChB,YAAM,eAAe,MAAMC,eAAgB;AAAA,QACzC;AAAA,QACA,uBAAuB;AAAA,QACvB,mBAAmB;AAAA,MAAA,CACpB;AACD,aAAO,kBAAkB,aAAa,WAAW,aAAa;AAAA,IAChE;AAEA,OAAG,MAAA;AACH,WAAO,UAAU,OAAO,OAAO,WAAW;AAAA,EAE5C,SAAS,OAAO;AACd,WAAO,UAAU;AACjB,WAAO,OAAO,KAAK,OAAO,KAAK,CAAC;AAAA,EAClC;AAEA,SAAO;AACT;"}