{"version":3,"file":"plugin.js","sources":["../../../../src/plugins/analyzers/code-complexity/plugin.ts"],"sourcesContent":["/**\n * Code Complexity Analyzer Plugin\n *\n * Implements the AnalyzerPlugin interface for analyzing TypeScript/JavaScript\n * code complexity. Provides streaming analysis, cyclomatic complexity,\n * cognitive complexity, Halstead metrics, and deep nesting detection.\n *\n * @module plugins/analyzers/code-complexity/plugin\n */\n\nimport { parse, type TSESTree } from '@typescript-eslint/typescript-estree';\nimport { relative, extname, basename } from 'path';\nimport { createLogger } from '../../../utils/logger.js';\nimport type {\n  AnalyzerPlugin,\n  AnalysisInput,\n  AnalysisResult,\n  AnalysisStreamChunk,\n  PluginContext,\n} from '../../types.js';\nimport {\n  calculateCyclomaticComplexity,\n  calculateCognitiveComplexity,\n  calculateMaxNestingDepth,\n  calculateLinesOfCode,\n  countReturnStatements,\n  calculateMaintainabilityIndex,\n  calculateHalsteadMetrics,\n  classifyComplexityLevel,\n  detectComplexityIssues,\n  generateRecommendations,\n} from './metrics.js';\nimport type {\n  ComplexityScore,\n  ComplexityLevel,\n  FunctionAnalysis,\n  FunctionKind,\n  HalsteadMetrics,\n} from './types.js';\nimport { DEFAULT_THRESHOLDS, EMPTY_HALSTEAD_METRICS } from './types.js';\n\nconst logger = createLogger('code-complexity-analyzer-plugin');\n\n// ============================================================================\n// Plugin Configuration\n// ============================================================================\n\n/**\n * Configuration options for the Code Complexity Analyzer plugin\n */\nexport interface CodeComplexityPluginConfig {\n  /** Cyclomatic complexity threshold for \"high\" designation */\n  cyclomaticHigh?: number;\n  /** Cyclomatic complexity threshold for \"critical\" designation */\n  cyclomaticCritical?: number;\n  /** Cognitive complexity threshold for \"high\" designation */\n  cognitiveHigh?: number;\n  /** Cognitive complexity threshold for \"critical\" designation */\n  cognitiveCritical?: number;\n  /** Maximum recommended nesting depth */\n  maxNestingDepth?: number;\n  /** Maximum recommended function length (LOC) */\n  maxFunctionLength?: number;\n  /** Include Halstead metrics in analysis */\n  includeHalstead?: boolean;\n  /** Minimum complexity to include in results (filter out simple functions) */\n  minComplexityToReport?: number;\n}\n\n// ============================================================================\n// Code Complexity Analyzer Plugin\n// ============================================================================\n\n/**\n * Code Complexity Analyzer Plugin\n *\n * Implements the AnalyzerPlugin interface for analyzing code complexity\n * in TypeScript and JavaScript files.\n *\n * Features:\n * - Cyclomatic complexity (McCabe) calculation\n * - Cognitive complexity (SonarSource) calculation\n * - Halstead software science metrics\n * - Deep nesting detection (> 4 levels)\n * - Lines of code counting\n * - Function and class counting\n * - Streaming analysis support\n * - Structured entity and relationship extraction\n *\n * @example\n * ```typescript\n * const plugin = new CodeComplexityAnalyzerPlugin();\n * await plugin.initialize(context);\n *\n * const result = await plugin.analyze({\n *   id: 'analysis-1',\n *   content: sourceCode,\n *   contentType: 'typescript',\n *   filePath: '/src/example.ts'\n * });\n *\n * console.log(`Found ${result.entities?.length} entities`);\n * ```\n */\nexport class CodeComplexityAnalyzerPlugin implements AnalyzerPlugin {\n  readonly name = 'code-complexity-analyzer';\n  readonly version = '1.0.0';\n  readonly type = 'analyzer' as const;\n  readonly supportedContentTypes = ['typescript', 'javascript', 'tsx', 'jsx'];\n\n  private context: PluginContext | null = null;\n  private config: CodeComplexityPluginConfig = {};\n  private thresholds = { ...DEFAULT_THRESHOLDS };\n\n  // ==========================================================================\n  // Lifecycle Methods\n  // ==========================================================================\n\n  /**\n   * Initialize the plugin with context\n   */\n  async initialize(context: PluginContext): Promise<void> {\n    this.context = context;\n\n    // Load configuration from plugin config\n    if (context.pluginConfig) {\n      this.config = context.pluginConfig as CodeComplexityPluginConfig;\n      this.thresholds = {\n        cyclomaticHigh: this.config.cyclomaticHigh ?? DEFAULT_THRESHOLDS.cyclomaticHigh,\n        cyclomaticCritical: this.config.cyclomaticCritical ?? DEFAULT_THRESHOLDS.cyclomaticCritical,\n        cognitiveHigh: this.config.cognitiveHigh ?? DEFAULT_THRESHOLDS.cognitiveHigh,\n        cognitiveCritical: this.config.cognitiveCritical ?? DEFAULT_THRESHOLDS.cognitiveCritical,\n        maxNestingDepth: this.config.maxNestingDepth ?? DEFAULT_THRESHOLDS.maxNestingDepth,\n        maxFunctionLength: this.config.maxFunctionLength ?? DEFAULT_THRESHOLDS.maxFunctionLength,\n      };\n    }\n\n    logger.info('Code Complexity Analyzer Plugin initialized', {\n      thresholds: this.thresholds,\n    });\n  }\n\n  /**\n   * Cleanup plugin resources\n   */\n  async destroy(): Promise<void> {\n    this.context = null;\n    logger.info('Code Complexity Analyzer Plugin destroyed');\n  }\n\n  /**\n   * Check plugin health\n   */\n  async healthCheck(): Promise<{ healthy: boolean; message?: string; details?: Record<string, unknown> }> {\n    return {\n      healthy: true,\n      message: 'Code Complexity Analyzer is ready',\n      details: {\n        supportedContentTypes: this.supportedContentTypes,\n        thresholds: this.thresholds,\n      },\n    };\n  }\n\n  /**\n   * Get plugin statistics\n   */\n  async getStats(): Promise<Record<string, unknown>> {\n    return {\n      name: this.name,\n      version: this.version,\n      supportedContentTypes: this.supportedContentTypes,\n      thresholds: this.thresholds,\n    };\n  }\n\n  // ==========================================================================\n  // Analyzer Interface Methods\n  // ==========================================================================\n\n  /**\n   * Check if this analyzer can handle the given content type\n   */\n  canAnalyze(contentType: string): boolean {\n    const normalizedType = contentType.toLowerCase().replace(/^\\./, '');\n    return this.supportedContentTypes.includes(normalizedType) ||\n           ['ts', 'js', 'mts', 'mjs', 'cts', 'cjs'].includes(normalizedType);\n  }\n\n  /**\n   * Analyze content and return structured results\n   */\n  async analyze(input: AnalysisInput): Promise<AnalysisResult> {\n    const startTime = Date.now();\n\n    logger.debug('Analyzing content', {\n      id: input.id,\n      contentType: input.contentType,\n      filePath: input.filePath,\n    });\n\n    const result: AnalysisResult = {\n      success: false,\n      analysisType: 'code-complexity',\n      entities: [],\n      relationships: [],\n      tags: [],\n      metrics: {\n        durationMs: 0,\n        tokensProcessed: 0,\n        entitiesFound: 0,\n        relationshipsFound: 0,\n      },\n      suggestions: [],\n    };\n\n    try {\n      // Parse the AST\n      const ast = this.parseContent(input.content, input.contentType);\n      if (!ast) {\n        result.error = {\n          code: 'PARSE_ERROR',\n          message: 'Failed to parse source code',\n        };\n        return result;\n      }\n\n      // Extract functions and analyze\n      const functions = this.extractAndAnalyzeFunctions(ast, input.content, input.filePath || 'unknown');\n\n      // Calculate file-level metrics\n      const { loc, totalLines } = calculateLinesOfCode(input.content, 1, input.content.split('\\n').length);\n      const classCount = this.countClasses(ast);\n      const importCount = this.countImports(ast);\n\n      // Generate entities from functions\n      for (const fn of functions) {\n        const entityId = `${input.id}-fn-${fn.name}-${fn.startLine}`;\n\n        result.entities!.push({\n          id: entityId,\n          type: 'function',\n          value: fn.name,\n          confidence: 1.0,\n          position: {\n            start: fn.startLine,\n            end: fn.endLine,\n          },\n          metadata: {\n            kind: fn.kind,\n            isAsync: fn.isAsync,\n            parentName: fn.parentName,\n            complexity: fn.complexity,\n            level: fn.level,\n            issues: fn.issues,\n            recommendations: fn.recommendations,\n          },\n        });\n\n        // Add relationships for nested functions or class methods\n        if (fn.parentName) {\n          result.relationships!.push({\n            sourceId: entityId,\n            targetId: `${input.id}-class-${fn.parentName}`,\n            type: 'belongs_to',\n            confidence: 1.0,\n            metadata: {\n              relationship: 'method_of_class',\n            },\n          });\n        }\n      }\n\n      // Add class entities\n      const classNames = this.extractClassNames(ast);\n      for (const className of classNames) {\n        result.entities!.push({\n          id: `${input.id}-class-${className}`,\n          type: 'class',\n          value: className,\n          confidence: 1.0,\n          metadata: {\n            methodCount: functions.filter(f => f.parentName === className).length,\n          },\n        });\n      }\n\n      // Generate tags based on complexity\n      const complexFunctions = functions.filter(f => f.level === 'high' || f.level === 'critical');\n      const avgCyclomatic = functions.length > 0\n        ? functions.reduce((sum, f) => sum + f.complexity.cyclomatic, 0) / functions.length\n        : 0;\n\n      result.tags = [\n        { value: 'code-complexity', confidence: 1.0, category: 'analysis' },\n        { value: input.contentType, confidence: 1.0, category: 'language' },\n      ];\n\n      if (complexFunctions.length > 0) {\n        result.tags.push({\n          value: 'has-complex-functions',\n          confidence: 1.0,\n          category: 'quality',\n        });\n      }\n\n      if (avgCyclomatic > this.thresholds.cyclomaticHigh) {\n        result.tags.push({\n          value: 'high-complexity',\n          confidence: 1.0,\n          category: 'quality',\n        });\n      }\n\n      // Generate suggestions\n      for (const fn of complexFunctions) {\n        result.suggestions!.push({\n          type: 'other',\n          message: `Function \"${fn.name}\" has ${fn.level} complexity (CC: ${fn.complexity.cyclomatic}). Consider refactoring.`,\n          confidence: 0.9,\n          action: {\n            type: 'refactor',\n            function: fn.name,\n            location: { line: fn.startLine, file: input.filePath },\n            recommendations: fn.recommendations,\n          },\n        });\n      }\n\n      // Generate summary\n      result.summary = this.generateSummary(functions, loc, classCount);\n\n      // Calculate quality score (0-1 based on complexity distribution)\n      const criticalCount = functions.filter(f => f.level === 'critical').length;\n      const highCount = functions.filter(f => f.level === 'high').length;\n      const totalFunctions = functions.length || 1;\n      result.qualityScore = Math.max(0, 1 - (criticalCount * 0.3 + highCount * 0.1) / totalFunctions);\n\n      // Update metrics\n      result.metrics = {\n        durationMs: Date.now() - startTime,\n        tokensProcessed: input.content.length,\n        entitiesFound: result.entities!.length,\n        relationshipsFound: result.relationships!.length,\n      };\n\n      // Add raw data for debugging\n      result.raw = {\n        totalFunctions: functions.length,\n        complexFunctions: complexFunctions.length,\n        loc,\n        totalLines,\n        classCount,\n        importCount,\n        avgCyclomatic: Math.round(avgCyclomatic * 100) / 100,\n        fileComplexity: functions.reduce((sum, f) => sum + f.complexity.cyclomatic, 0),\n      };\n\n      result.success = true;\n\n    } catch (error) {\n      const message = error instanceof Error ? error.message : String(error);\n      result.error = {\n        code: 'ANALYSIS_ERROR',\n        message,\n        details: { error },\n      };\n      logger.error('Analysis failed', error instanceof Error ? error : new Error(message));\n    }\n\n    result.metrics!.durationMs = Date.now() - startTime;\n    return result;\n  }\n\n  /**\n   * Stream analysis results for large content\n   */\n  async *analyzeStream(input: AnalysisInput): AsyncIterable<AnalysisStreamChunk> {\n    const startTime = Date.now();\n\n    yield {\n      type: 'progress',\n      data: { stage: 'parsing', message: 'Parsing source code...' },\n      progress: 10,\n      timestamp: new Date(),\n    };\n\n    // Parse AST\n    const ast = this.parseContent(input.content, input.contentType);\n    if (!ast) {\n      yield {\n        type: 'error',\n        data: { code: 'PARSE_ERROR', message: 'Failed to parse source code' },\n        timestamp: new Date(),\n      };\n      return;\n    }\n\n    yield {\n      type: 'progress',\n      data: { stage: 'extracting', message: 'Extracting functions...' },\n      progress: 30,\n      timestamp: new Date(),\n    };\n\n    // Extract and analyze functions\n    const functions = this.extractAndAnalyzeFunctions(ast, input.content, input.filePath || 'unknown');\n    const totalFunctions = functions.length;\n\n    // Stream each function as an entity\n    for (let i = 0; i < functions.length; i++) {\n      const fn = functions[i];\n      const entityId = `${input.id}-fn-${fn.name}-${fn.startLine}`;\n\n      yield {\n        type: 'entity',\n        data: {\n          id: entityId,\n          type: 'function',\n          value: fn.name,\n          confidence: 1.0,\n          position: { start: fn.startLine, end: fn.endLine },\n          metadata: {\n            kind: fn.kind,\n            isAsync: fn.isAsync,\n            parentName: fn.parentName,\n            complexity: fn.complexity,\n            level: fn.level,\n            issues: fn.issues,\n            recommendations: fn.recommendations,\n          },\n        },\n        progress: 30 + Math.round((i / totalFunctions) * 50),\n        timestamp: new Date(),\n      };\n\n      // Stream relationships\n      if (fn.parentName) {\n        yield {\n          type: 'relationship',\n          data: {\n            sourceId: entityId,\n            targetId: `${input.id}-class-${fn.parentName}`,\n            type: 'belongs_to',\n            confidence: 1.0,\n          },\n          timestamp: new Date(),\n        };\n      }\n    }\n\n    yield {\n      type: 'progress',\n      data: { stage: 'extracting-classes', message: 'Extracting classes...' },\n      progress: 85,\n      timestamp: new Date(),\n    };\n\n    // Stream class entities\n    const classNames = this.extractClassNames(ast);\n    for (const className of classNames) {\n      yield {\n        type: 'entity',\n        data: {\n          id: `${input.id}-class-${className}`,\n          type: 'class',\n          value: className,\n          confidence: 1.0,\n          metadata: {\n            methodCount: functions.filter(f => f.parentName === className).length,\n          },\n        },\n        timestamp: new Date(),\n      };\n    }\n\n    // Stream tags\n    yield {\n      type: 'tag',\n      data: { value: 'code-complexity', confidence: 1.0, category: 'analysis' },\n      progress: 95,\n      timestamp: new Date(),\n    };\n\n    // Complete\n    yield {\n      type: 'complete',\n      data: {\n        totalFunctions: functions.length,\n        complexFunctions: functions.filter(f => f.level === 'high' || f.level === 'critical').length,\n        durationMs: Date.now() - startTime,\n      },\n      progress: 100,\n      timestamp: new Date(),\n    };\n  }\n\n  /**\n   * Get configuration options for this analyzer\n   */\n  getConfigOptions(): Record<string, {\n    type: 'string' | 'number' | 'boolean' | 'array' | 'object';\n    description: string;\n    default?: unknown;\n    required?: boolean;\n  }> {\n    return {\n      cyclomaticHigh: {\n        type: 'number',\n        description: 'Cyclomatic complexity threshold for \"high\" designation',\n        default: 10,\n      },\n      cyclomaticCritical: {\n        type: 'number',\n        description: 'Cyclomatic complexity threshold for \"critical\" designation',\n        default: 20,\n      },\n      cognitiveHigh: {\n        type: 'number',\n        description: 'Cognitive complexity threshold for \"high\" designation',\n        default: 15,\n      },\n      cognitiveCritical: {\n        type: 'number',\n        description: 'Cognitive complexity threshold for \"critical\" designation',\n        default: 25,\n      },\n      maxNestingDepth: {\n        type: 'number',\n        description: 'Maximum recommended nesting depth',\n        default: 4,\n      },\n      maxFunctionLength: {\n        type: 'number',\n        description: 'Maximum recommended function length in lines',\n        default: 50,\n      },\n      includeHalstead: {\n        type: 'boolean',\n        description: 'Include Halstead software science metrics',\n        default: true,\n      },\n      minComplexityToReport: {\n        type: 'number',\n        description: 'Minimum cyclomatic complexity to include in results',\n        default: 0,\n      },\n    };\n  }\n\n  // ==========================================================================\n  // Private Helper Methods\n  // ==========================================================================\n\n  /**\n   * Parse source code to AST\n   */\n  private parseContent(content: string, contentType: string): TSESTree.Program | null {\n    const isTypeScript = ['typescript', 'tsx', 'ts'].includes(contentType.toLowerCase());\n    const isJsx = ['tsx', 'jsx'].includes(contentType.toLowerCase());\n\n    try {\n      return parse(content, {\n        loc: true,\n        range: true,\n        tokens: false,\n        comment: false,\n        jsx: isJsx,\n        ...(isTypeScript ? {} : { allowInvalidAST: true }),\n      });\n    } catch (error) {\n      logger.debug('Parse error', {\n        error: error instanceof Error ? error.message : String(error),\n      });\n      return null;\n    }\n  }\n\n  /**\n   * Extract and analyze all functions from AST\n   */\n  private extractAndAnalyzeFunctions(\n    ast: TSESTree.Program,\n    sourceCode: string,\n    filePath: string\n  ): FunctionAnalysis[] {\n    const functions: FunctionAnalysis[] = [];\n\n    const traverse = (node: TSESTree.Node, parentName?: string): void => {\n      const functionInfo = this.getFunctionInfo(node, parentName);\n      if (functionInfo) {\n        const analysis = this.analyzeFunctionNode(\n          functionInfo.node,\n          functionInfo.name,\n          functionInfo.kind,\n          filePath,\n          sourceCode,\n          functionInfo.isAsync,\n          functionInfo.isExported,\n          functionInfo.parentName\n        );\n        functions.push(analysis);\n      }\n\n      // Track class names for methods\n      let newParentName = parentName;\n      if (node.type === 'ClassDeclaration' || node.type === 'ClassExpression') {\n        const classNode = node as TSESTree.ClassDeclaration;\n        newParentName = classNode.id?.name ?? 'AnonymousClass';\n      }\n\n      // Traverse children\n      for (const key of Object.keys(node)) {\n        if (key === 'parent') continue;\n        const child = (node as unknown as Record<string, unknown>)[key];\n        if (child && typeof child === 'object') {\n          if (Array.isArray(child)) {\n            for (const item of child) {\n              if (item && typeof item === 'object' && 'type' in item) {\n                traverse(item as TSESTree.Node, newParentName);\n              }\n            }\n          } else if ('type' in child) {\n            traverse(child as TSESTree.Node, newParentName);\n          }\n        }\n      }\n    };\n\n    traverse(ast);\n    return functions;\n  }\n\n  /**\n   * Get function information from node\n   */\n  private getFunctionInfo(\n    node: TSESTree.Node,\n    parentName?: string\n  ): {\n    node: TSESTree.Node;\n    name: string;\n    kind: FunctionKind;\n    isAsync: boolean;\n    isExported: boolean;\n    parentName?: string;\n  } | null {\n    switch (node.type) {\n      case 'FunctionDeclaration': {\n        const fn = node as TSESTree.FunctionDeclaration;\n        return {\n          node: fn,\n          name: fn.id?.name ?? 'anonymous',\n          kind: fn.generator ? 'generator' : 'function',\n          isAsync: fn.async,\n          isExported: false,\n          parentName,\n        };\n      }\n\n      case 'FunctionExpression': {\n        const fn = node as TSESTree.FunctionExpression;\n        return {\n          node: fn,\n          name: fn.id?.name ?? 'anonymous',\n          kind: fn.generator ? 'generator' : 'function',\n          isAsync: fn.async,\n          isExported: false,\n          parentName,\n        };\n      }\n\n      case 'ArrowFunctionExpression': {\n        const fn = node as TSESTree.ArrowFunctionExpression;\n        return {\n          node: fn,\n          name: 'arrow',\n          kind: 'arrow',\n          isAsync: fn.async,\n          isExported: false,\n          parentName,\n        };\n      }\n\n      case 'MethodDefinition': {\n        const method = node as TSESTree.MethodDefinition;\n        const methodName = this.getPropertyName(method.key) ?? 'method';\n        let kind: FunctionKind;\n        if (method.kind === 'constructor') {\n          kind = 'constructor';\n        } else if (method.kind === 'get') {\n          kind = 'getter';\n        } else if (method.kind === 'set') {\n          kind = 'setter';\n        } else {\n          kind = 'method';\n        }\n        const fn = method.value as TSESTree.FunctionExpression;\n        return {\n          node: method.value,\n          name: methodName,\n          kind,\n          isAsync: fn.async,\n          isExported: false,\n          parentName,\n        };\n      }\n\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Analyze a single function node\n   */\n  private analyzeFunctionNode(\n    node: TSESTree.Node,\n    name: string,\n    kind: FunctionKind,\n    filePath: string,\n    sourceCode: string,\n    isAsync: boolean,\n    isExported: boolean,\n    parentName?: string\n  ): FunctionAnalysis {\n    const startLine = node.loc?.start.line ?? 1;\n    const endLine = node.loc?.end.line ?? 1;\n\n    // Calculate complexity metrics\n    const cyclomatic = calculateCyclomaticComplexity(node);\n    const cognitive = calculateCognitiveComplexity(node);\n    const maxNestingDepth = calculateMaxNestingDepth(node);\n    const { loc, totalLines } = calculateLinesOfCode(sourceCode, startLine, endLine);\n    const returnCount = countReturnStatements(node);\n    const parameterCount = this.getParameterCount(node);\n\n    // Calculate Halstead metrics if enabled\n    const halstead = this.config.includeHalstead !== false\n      ? calculateHalsteadMetrics(node)\n      : undefined;\n\n    const complexity: ComplexityScore = {\n      cyclomatic,\n      cognitive,\n      loc,\n      totalLines,\n      maxNestingDepth,\n      parameterCount,\n      returnCount,\n      halstead,\n    };\n\n    // Classify complexity level\n    const level = classifyComplexityLevel(complexity, this.thresholds);\n\n    // Detect issues\n    const issues = detectComplexityIssues(complexity, this.thresholds, name);\n\n    // Add deep nesting detection\n    if (maxNestingDepth > this.thresholds.maxNestingDepth) {\n      issues.push(`Deep nesting detected: ${maxNestingDepth} levels (threshold: ${this.thresholds.maxNestingDepth})`);\n    }\n\n    // Generate recommendations\n    const recommendations = generateRecommendations(complexity, this.thresholds, level);\n\n    return {\n      name,\n      filePath,\n      startLine,\n      endLine,\n      kind,\n      complexity,\n      level,\n      parentName,\n      isAsync,\n      isExported,\n      issues,\n      recommendations,\n    };\n  }\n\n  /**\n   * Get property name from key\n   */\n  private getPropertyName(key: TSESTree.Node): string | null {\n    if (key.type === 'Identifier') {\n      return (key as TSESTree.Identifier).name;\n    }\n    if (key.type === 'Literal') {\n      return String((key as TSESTree.Literal).value);\n    }\n    return null;\n  }\n\n  /**\n   * Get parameter count from function\n   */\n  private getParameterCount(node: TSESTree.Node): number {\n    if ('params' in node && Array.isArray(node.params)) {\n      return node.params.length;\n    }\n    return 0;\n  }\n\n  /**\n   * Count imports in AST\n   */\n  private countImports(ast: TSESTree.Program): number {\n    return ast.body.filter(n => n.type === 'ImportDeclaration').length;\n  }\n\n  /**\n   * Count classes in AST\n   */\n  private countClasses(ast: TSESTree.Program): number {\n    let count = 0;\n    const traverse = (node: TSESTree.Node): void => {\n      if (node.type === 'ClassDeclaration' || node.type === 'ClassExpression') {\n        count++;\n      }\n      for (const key of Object.keys(node)) {\n        if (key === 'parent') continue;\n        const child = (node as unknown as Record<string, unknown>)[key];\n        if (child && typeof child === 'object') {\n          if (Array.isArray(child)) {\n            for (const item of child) {\n              if (item && typeof item === 'object' && 'type' in item) {\n                traverse(item as TSESTree.Node);\n              }\n            }\n          } else if ('type' in child) {\n            traverse(child as TSESTree.Node);\n          }\n        }\n      }\n    };\n    traverse(ast);\n    return count;\n  }\n\n  /**\n   * Extract class names from AST\n   */\n  private extractClassNames(ast: TSESTree.Program): string[] {\n    const names: string[] = [];\n    const traverse = (node: TSESTree.Node): void => {\n      if (node.type === 'ClassDeclaration' || node.type === 'ClassExpression') {\n        const classNode = node as TSESTree.ClassDeclaration;\n        if (classNode.id?.name) {\n          names.push(classNode.id.name);\n        }\n      }\n      for (const key of Object.keys(node)) {\n        if (key === 'parent') continue;\n        const child = (node as unknown as Record<string, unknown>)[key];\n        if (child && typeof child === 'object') {\n          if (Array.isArray(child)) {\n            for (const item of child) {\n              if (item && typeof item === 'object' && 'type' in item) {\n                traverse(item as TSESTree.Node);\n              }\n            }\n          } else if ('type' in child) {\n            traverse(child as TSESTree.Node);\n          }\n        }\n      }\n    };\n    traverse(ast);\n    return names;\n  }\n\n  /**\n   * Generate a summary of the analysis\n   */\n  private generateSummary(functions: FunctionAnalysis[], loc: number, classCount: number): string {\n    const totalFunctions = functions.length;\n    const complexFunctions = functions.filter(f => f.level === 'high' || f.level === 'critical').length;\n    const avgCyclomatic = totalFunctions > 0\n      ? Math.round(functions.reduce((sum, f) => sum + f.complexity.cyclomatic, 0) / totalFunctions * 100) / 100\n      : 0;\n    const avgCognitive = totalFunctions > 0\n      ? Math.round(functions.reduce((sum, f) => sum + f.complexity.cognitive, 0) / totalFunctions * 100) / 100\n      : 0;\n\n    return `Analyzed ${totalFunctions} functions and ${classCount} classes across ${loc} lines of code. ` +\n      `Average cyclomatic complexity: ${avgCyclomatic}, cognitive complexity: ${avgCognitive}. ` +\n      `Found ${complexFunctions} function(s) with high or critical complexity.`;\n  }\n}\n\n// ============================================================================\n// Factory Functions\n// ============================================================================\n\n/**\n * Create a new Code Complexity Analyzer Plugin instance\n */\nexport function createCodeComplexityAnalyzerPlugin(): CodeComplexityAnalyzerPlugin {\n  return new CodeComplexityAnalyzerPlugin();\n}\n\n/**\n * Default export for plugin discovery\n */\nexport default CodeComplexityAnalyzerPlugin;\n"],"names":["parse"],"mappings":"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"}