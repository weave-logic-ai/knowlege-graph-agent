---
title: Data & Knowledge Graph Layer
type: architecture
status: planned
tags:
  - architecture
  - data
  - knowledge-graph
  - database
  - temporal
  - type/architecture
  - status/in-progress
priority: medium
related:
  - '[[../technical/graphiti]]'
  - '[[../technical/postgresql]]'
  - '[[../technical/supabase]]'
  - '[[../concepts/knowledge-graph]]'
  - '[[../concepts/temporal-queries]]'
  - '[[api-layer]]'
visual:
  icon: "\U0001F3D7Ô∏è"
  color: '#F59E0B'
  cssclasses:
    - type-architecture
    - status-planned
updated: '2025-10-29T04:55:03.424Z'
version: '3.0'
keywords:
  - database foundation
  - knowledge graph structure
  - temporal awareness
  - embeddings and semantic search
  - graphiti integration
  - related
  - architecture
  - technical
  - concepts
  - features
---

# Data & Knowledge Graph Layer

The data and knowledge graph layer provides persistent storage, graph structure management, and temporal querying capabilities for Weave-NN's knowledge assets. This foundational layer transforms markdown documents and their relationships into queryable, evolving knowledge structures.

## Database Foundation

[[../technical/postgresql|PostgreSQL]] serves as the persistence engine, leveraging its relational integrity, JSON support, and graph extension capabilities. Each markdown document becomes a database record with structured metadata, content storage, and relationship tracking. Node tables store document properties - titles, tags, creation dates, authors, AI-generation flags. Edge tables capture relationships between nodes, including relationship types, strength indicators, and temporal metadata.

PostgreSQL's JSON columns accommodate flexible metadata schemas, allowing documents to carry custom properties without rigid table alterations. Full-text search indexes enable content queries, while btree indexes optimize graph traversal queries. Stored procedures encapsulate complex graph operations, reducing round-trip overhead for multi-hop relationship queries.

## Knowledge Graph Structure

The [[../concepts/knowledge-graph|knowledge graph]] data model represents documents as typed nodes with directed edges capturing relationships. Node types include document nodes, concept nodes, tag nodes, user nodes, and temporal anchor nodes. Edge types encode semantic relationships - references through wikilinks, AI-detected similarities, hierarchical parent-child structures, temporal sequences, and logical relationships like contradicts or extends.

Graph schema design balances normalization and query performance. Denormalized relationship tables accelerate graph traversal at the cost of storage overhead. Materialized views cache expensive aggregations like node centrality scores or cluster memberships. Partial indexes optimize common query patterns while minimizing index maintenance costs.

## Temporal Awareness

[[../concepts/temporal-queries|Temporal knowledge graphs]] require tracking how nodes and relationships evolve over time. [[../technical/graphiti|Graphiti]] integration provides native temporal support, storing validity periods for facts and relationships. Point-in-time queries reconstruct graph state at historical moments, answering questions like "what did we know about authentication on October 15?"

Version history tables track document modifications, linking changes to users and timestamps. Soft deletes preserve historical context, marking nodes as inactive rather than removing them. Change logs enable audit trails and rollback capabilities, critical for collaborative editing scenarios.

Temporal invalidation mechanisms flag outdated information. When core concepts change, the system propagates invalidation through dependent nodes, alerting users to potentially stale references. AI agents can query temporal context to avoid generating content based on superseded information.

## Embeddings and Semantic Search

Vector embeddings transform document content into semantic representations, enabling similarity searches beyond keyword matching. Embedding columns store dense vectors generated by language models, capturing semantic meaning. Vector similarity indexes using pgvector or specialized vector databases enable efficient nearest-neighbor searches.

Semantic search combines vector similarity with graph structure, ranking results by both content relevance and relationship proximity. Users find related concepts even when terminology differs, discovering connections invisible to traditional search. AI agents leverage embeddings to suggest relationship creation, automatically linking semantically related nodes.

## Graphiti Integration

[[../technical/graphiti|Graphiti]] provides an alternative to PostgreSQL graph extensions, offering LLM-native graph management with temporal awareness built-in. Its episodic memory grouping clusters related nodes by conversation or time period, natural for knowledge evolved through AI interaction. Entity resolution deduplicates similar concepts, maintaining graph cleanliness as content accumulates.

The Graphiti integration decision involves trade-offs between maturity and temporal-native design. PostgreSQL with extensions offers battle-tested reliability and operational familiarity. Graphiti provides temporal reasoning as a first-class feature, simplifying time-aware queries but requiring investment in an emerging technology.





## Related

[[neural-network-junction]]
## Related

[[knowledge-graph-integration-architecture]]
## Related

### Architecture
- [[api-layer]] - Accesses data layer through queries
- [[frontend-layer]] - Visualizes graph data structures
- [[ai-integration-layer]] - Reads and writes graph data

### Technical
- [[../technical/postgresql]] - Relational database foundation
- [[../technical/graphiti]] - Temporal graph engine option
- [[../technical/supabase]] - Managed PostgreSQL platform

### Concepts
- [[../concepts/knowledge-graph]] - Conceptual graph model
- [[../concepts/temporal-queries]] - Time-aware querying
- [[../concepts/wikilinks]] - Relationship creation mechanism

### Features
- [[../features/semantic-search]] - Vector-based search
- [[../features/version-history]] - Temporal document tracking
- [[../features/graph-analytics]] - Graph metric computation

---

**Created**: 2025-10-21
**Last Updated**: 2025-10-21
**Status**: Planned
